<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Convex Hull in 2D | Yue&#39;s Notes</title>
<meta name="keywords" content="">
<meta name="description" content="Definition Problem: Given $n$ points $P = \set{p_1, \ldots, p_n} \subset \mathbb{R}^2$, compute $\text{CH}(P) = $ smallest convex set contining $P$.
Input: a list of points all the points in $P$.
Output: a list of points in $P$ that belongs to this convex set in CCW, starting from the left most point.
Applications Given a huge point cloud, convex hull helps find the &ldquo;shape&rdquo;.
Bounding volume. Makes ray shooting tasks faster.">
<meta name="author" content="">
<link rel="canonical" href="https://ohuro.me/posts/convex_hull/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://ohuro.me/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ohuro.me/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ohuro.me/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ohuro.me/apple-touch-icon.png">
<link rel="mask-icon" href="https://ohuro.me/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

 

 <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
 <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 
 
 <script>
   MathJax = {
     tex: {
       inlineMath: [['$', '$'], ['\\(', '\\)']],
       displayMath: [['$$','$$'], ['\\[', '\\]']],
       processEscapes: true,
       processEnvironments: true
     },
     options: {
       skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
     }
   };
 
   window.addEventListener('load', (event) => {
       document.querySelectorAll("mjx-container").forEach(function(x){
         x.parentElement.classList += 'has-jax'})
     });
 
 </script>


<script src="//yihui.org/js/math-code.js" defer></script>

<meta property="og:title" content="Convex Hull in 2D" />
<meta property="og:description" content="Definition Problem: Given $n$ points $P = \set{p_1, \ldots, p_n} \subset \mathbb{R}^2$, compute $\text{CH}(P) = $ smallest convex set contining $P$.
Input: a list of points all the points in $P$.
Output: a list of points in $P$ that belongs to this convex set in CCW, starting from the left most point.
Applications Given a huge point cloud, convex hull helps find the &ldquo;shape&rdquo;.
Bounding volume. Makes ray shooting tasks faster." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ohuro.me/posts/convex_hull/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-08-29T17:02:49-05:00" />
<meta property="article:modified_time" content="2024-08-29T17:02:49-05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Convex Hull in 2D"/>
<meta name="twitter:description" content="Definition Problem: Given $n$ points $P = \set{p_1, \ldots, p_n} \subset \mathbb{R}^2$, compute $\text{CH}(P) = $ smallest convex set contining $P$.
Input: a list of points all the points in $P$.
Output: a list of points in $P$ that belongs to this convex set in CCW, starting from the left most point.
Applications Given a huge point cloud, convex hull helps find the &ldquo;shape&rdquo;.
Bounding volume. Makes ray shooting tasks faster."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://ohuro.me/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Convex Hull in 2D",
      "item": "https://ohuro.me/posts/convex_hull/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Convex Hull in 2D",
  "name": "Convex Hull in 2D",
  "description": "Definition Problem: Given $n$ points $P = \\set{p_1, \\ldots, p_n} \\subset \\mathbb{R}^2$, compute $\\text{CH}(P) = $ smallest convex set contining $P$.\nInput: a list of points all the points in $P$.\nOutput: a list of points in $P$ that belongs to this convex set in CCW, starting from the left most point.\nApplications Given a huge point cloud, convex hull helps find the \u0026ldquo;shape\u0026rdquo;.\nBounding volume. Makes ray shooting tasks faster.",
  "keywords": [
    
  ],
  "articleBody": "Definition Problem: Given $n$ points $P = \\set{p_1, \\ldots, p_n} \\subset \\mathbb{R}^2$, compute $\\text{CH}(P) = $ smallest convex set contining $P$.\nInput: a list of points all the points in $P$.\nOutput: a list of points in $P$ that belongs to this convex set in CCW, starting from the left most point.\nApplications Given a huge point cloud, convex hull helps find the “shape”.\nBounding volume. Makes ray shooting tasks faster.\nExtreme points. It gives the most extreme points in any given direction.\nFarthest pair.\nLine separation. Natural, but not fastest.\nNow, let’s design some algorithms!\nMath properties $$ \\begin{align*} \\text{CH}(P) \u0026= \\bigcap_{\\text{convex } S \\supseteq P} S = \\bigcap_{\\text{half plane } h \\supseteq P} h \\\\ \u0026= \\set{ \\text{all convex combinations of } p_1, \\ldots, p_n}\\\\ \u0026= \\bigcup_{i, j, k} \\set{\\text{all convex triples $i, j, k$ (triangle)}} \\end{align*} $$\nConvex combination: $$ \\sum_{i = 1}^{n} a_i p_i, \\; \\sum_{i = 1}^{n} a_i = 1, a_i \\geq 0. $$\nLemma $p_i$ is a vertex of $\\text{CH}(P)$ iff $\\exists$ line through $p_i$ such that $P$ lines on one side. (all other points on one side.)\nLemma $p_i p_j$ is an edge of $\\text{CH}(P)$ iff $P$ lines on one side of line $p_ip_j$.\nNote: suffice to compute upper hull(UH) to solve CH. UH is divided by $\\min x, \\max x$.\nBrute force for i = 1..n for j = 1..n flag = true for k = 1..n if p_k above p_i p_j then flag = false if flag then output p_i p_j $O(n^3)$ time.\nSome simple post processing is required to get the correct output.\nImplement issues: How to test $p_k$ is above $p_ip_j$? Degeneracies precision issues. 1. Test above Say $p_i$ is on the left of $p_j$ (smaller $x$).\nWe say $p_k$ below $p_ip_j$\niff $p_k$ is at the right of $\\vec{p_ip_j}$\niff $p_ip_jp_k$ is in CW order\niff $(x_k, y_k)$ below line with equation: $y - y_i = \\frac{y_j - y_i}{x_j - x_i}(x - x_i)$\niff $y_k - y_i \u003c \\frac{y_j - y_i}{x_j - x_i}(x_k - x_i)$ .\niff $(y_k - y_i)(x_j - x_i) \u003c (y_j - y_i)(x_k - x_i)$. This is a cross product!\niff $$ 2 \\cdot \\text{signed area of }\\Delta p_ip_jp_k \\begin{vmatrix} 1 \u0026 x_i \u0026 y_i\\\\ 1 \u0026 x_j \u0026 y_j\\\\ 1 \u0026 x_k \u0026 y_k\\\\ \\end{vmatrix} \u003c 0 $$\nThe good thing about the determinant test is that it extends to higher dimensions.\n2. Degeneracies What if some points are on the edge in real world data? We don’t consider it in theory :))) We consider the points in “general position”.\n3. Precision More messy stuff…\nAlgorithm 1: Jaruis March(1973) / “gift wrapping” Looks like a selection sort.\nIdea: go from one UH vertex to next.\nq_1 = the leftmost point. \u003c--- O(n) time. for i = 1 to n do { if (q_i = rightmost point) then { return (q_1, ..., q_i) } q_{i+1} = any init point to the right. for k = 1 to n do { if (p_k right of q_i) AND (p_k above q_iq_{i+1}) then { q_{i+1} = p_k } } } $O(n^2)$ running time.\nAlgorithm 2: Graham Scan (1972) Looks like an insertion sort.\nIdea:\nadd points one at a time and maintain the UH. (Incremental approach). go from left to right. (Sweeping technique) We add the highest point on the scanning line, then update the hull by relaxing. Keep deleting suffix untill a CW appears. I will skip the pseudocode.\nAnalysis: Naively $O(n^2)$. But, what if we bound the number of iterations for relaxation? Observation, the total relaxation time is bounded by $O(n)$. $$ O(n + \\# \\text{decrement}) \\leq O(n + \\# \\text{increment}) = O(n) $$ But we do have a sorting in $O(n \\log n)$.\n",
  "wordCount" : "618",
  "inLanguage": "en",
  "datePublished": "2024-08-29T17:02:49-05:00",
  "dateModified": "2024-08-29T17:02:49-05:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ohuro.me/posts/convex_hull/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Yue's Notes",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ohuro.me/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ohuro.me/" accesskey="h" title="Yue&#39;s Notes (Alt + H)">Yue&#39;s Notes</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ohuro.me/about" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="https://ohuro.me/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://ohuro.me/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://ohuro.me/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Convex Hull in 2D
    </h1>
    <div class="post-meta"><span title='2024-08-29 17:02:49 -0500 -0500'>August 29, 2024</span>

</div>
  </header> 
  <div class="post-content"><p><span style="color:#28a745">Definition</span> Problem: Given $n$ points $P = \set{p_1, \ldots, p_n} \subset \mathbb{R}^2$, compute $\text{CH}(P) = $ smallest convex set contining $P$.</p>
<p>Input: a list of points all the points in $P$.</p>
<p>Output: a list of points in $P$ that belongs to this convex set in CCW, starting from the left most point.</p>
<h4 id="applications">Applications<a hidden class="anchor" aria-hidden="true" href="#applications">#</a></h4>
<ul>
<li>
<p>Given a huge point cloud, convex hull helps find the &ldquo;shape&rdquo;.</p>
</li>
<li>
<p>Bounding volume. Makes ray shooting tasks faster.</p>
</li>
<li>
<p>Extreme points. It gives the most extreme points in any given direction.</p>
</li>
<li>
<p>Farthest pair.</p>
</li>
<li>
<p>Line separation. Natural, but not fastest.</p>
</li>
</ul>
<p>Now, let&rsquo;s design some algorithms!</p>
<h3 id="math-properties">Math properties<a hidden class="anchor" aria-hidden="true" href="#math-properties">#</a></h3>
<p><code>$$ \begin{align*} \text{CH}(P) &amp;= \bigcap_{\text{convex } S \supseteq P} S =  \bigcap_{\text{half plane } h \supseteq P} h \\ &amp;= \set{ \text{all convex combinations of } p_1, \ldots, p_n}\\ &amp;= \bigcup_{i, j, k} \set{\text{all convex triples $i, j, k$ (triangle)}} \end{align*} $$</code></p>
<p>Convex combination:
<code>$$ \sum_{i = 1}^{n} a_i p_i, \; \sum_{i = 1}^{n} a_i = 1, a_i \geq 0.  $$</code></p>
<p><span style="color:#599eff">Lemma</span> $p_i$ is a vertex of $\text{CH}(P)$ iff $\exists$   line through $p_i$ such that $P$ lines on one side. (all other points on one side.)</p>
<p><span style="color:#599eff">Lemma</span> $p_i p_j$ is an edge of $\text{CH}(P)$ iff $P$ lines on one side of line $p_ip_j$.</p>
<p>Note: suffice to compute upper hull(UH) to solve CH. UH is divided by $\min x, \max x$.</p>
<hr>
<h3 id="span-stylecolor3c66b5brute-forcespan"><span style="color:#3c66b5">Brute force</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor3c66b5brute-forcespan">#</a></h3>
<pre tabindex="0"><code class="language-pseudocode" data-lang="pseudocode">for i = 1..n
	for j = 1..n
		flag = true
		for k = 1..n
			if p_k above p_i p_j then flag = false
		if flag then output p_i p_j
</code></pre><p>$O(n^3)$ time.</p>
<p>Some simple post processing is required to get the correct output.</p>
<h4 id="implement-issues">Implement issues:<a hidden class="anchor" aria-hidden="true" href="#implement-issues">#</a></h4>
<ol>
<li>How to test $p_k$ is above $p_ip_j$?</li>
<li>Degeneracies</li>
<li>precision issues.</li>
</ol>
<h4 id="1-test-above">1. Test above<a hidden class="anchor" aria-hidden="true" href="#1-test-above">#</a></h4>
<p>Say $p_i$ is on the left of $p_j$ (smaller $x$).</p>
<p>We say $p_k$ below $p_ip_j$</p>
<ul>
<li>
<p>iff $p_k$ is at the right of $\vec{p_ip_j}$</p>
</li>
<li>
<p>iff $p_ip_jp_k$ is in CW order</p>
</li>
<li>
<p>iff $(x_k, y_k)$ below line with equation: $y - y_i = \frac{y_j - y_i}{x_j - x_i}(x - x_i)$</p>
</li>
<li>
<p>iff $y_k - y_i &lt; \frac{y_j - y_i}{x_j - x_i}(x_k - x_i)$ .</p>
</li>
<li>
<p>iff $(y_k - y_i)(x_j - x_i) &lt; (y_j - y_i)(x_k - x_i)$. This is a cross product!</p>
</li>
<li>
<p>iff
<code>$$ 2 \cdot \text{signed area of }\Delta  p_ip_jp_k \begin{vmatrix} 1 &amp; x_i &amp; y_i\\ 1 &amp; x_j &amp; y_j\\ 1 &amp; x_k &amp; y_k\\ \end{vmatrix} &lt; 0 $$</code></p>
</li>
</ul>
<p>The good thing about the determinant test is that it extends to higher dimensions.</p>
<h4 id="2-degeneracies">2. Degeneracies<a hidden class="anchor" aria-hidden="true" href="#2-degeneracies">#</a></h4>
<p>What if some points are on the edge in real world data? We don&rsquo;t consider it in theory :))) We consider the points in &ldquo;general position&rdquo;.</p>
<h4 id="3-precision">3. Precision<a hidden class="anchor" aria-hidden="true" href="#3-precision">#</a></h4>
<p>More messy stuff&hellip;</p>
<hr>
<h3 id="algorithm-1-jaruis-march1973--gift-wrapping">Algorithm 1: Jaruis March(1973) / &ldquo;gift wrapping&rdquo;<a hidden class="anchor" aria-hidden="true" href="#algorithm-1-jaruis-march1973--gift-wrapping">#</a></h3>
<blockquote>
<p>Looks like a selection sort.</p>
</blockquote>
<p>Idea: go from one UH vertex to next.</p>
<pre tabindex="0"><code class="language-pseudocode" data-lang="pseudocode">q_1 = the leftmost point. 		&lt;--- O(n) time.
for i = 1 to n do {
	if (q_i = rightmost point) then {
		return (q_1, ..., q_i)
	}
	q_{i+1} = any init point to the right.
	for k = 1 to n do {
		if (p_k right of q_i) AND (p_k above q_iq_{i+1}) then {
			q_{i+1} = p_k
		}
	}
}
</code></pre><p>$O(n^2)$ running time.</p>
<h3 id="algorithm-2-graham-scan-1972">Algorithm 2: Graham Scan (1972)<a hidden class="anchor" aria-hidden="true" href="#algorithm-2-graham-scan-1972">#</a></h3>
<blockquote>
<p>Looks like an insertion sort.</p>
</blockquote>
<p>Idea:</p>
<ul>
<li>add points one at a time and maintain the UH. (Incremental approach).</li>
<li>go from left to right. (Sweeping technique)</li>
<li>We add the highest point on the scanning line, then update the hull by relaxing. Keep deleting suffix untill a CW appears.</li>
</ul>
<p>I will skip the pseudocode.</p>
<h4 id="analysis">Analysis:<a hidden class="anchor" aria-hidden="true" href="#analysis">#</a></h4>
<p>Naively $O(n^2)$. But, what if we bound the number of iterations for relaxation? Observation, the total relaxation time is bounded by $O(n)$.
<code>$$ O(n + \# \text{decrement}) \leq O(n + \# \text{increment}) = O(n) $$</code>
But we do have a sorting in $O(n \log n)$.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://ohuro.me/">Yue&#39;s Notes</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
