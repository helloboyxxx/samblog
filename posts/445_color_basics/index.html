<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>445_color_basics | Yue's Notes</title>
<meta name=keywords content="Computational Photography"><meta name=description content="How do you view the world

Cones: cone-shaped, less sensitive, operate in high light, color vision
Rods: rod-shaped, highly sensitive, operate at night, gray-scale vision, slower to respond

Observation In a clear night, there are more stars off-center. This is because you have more rods in the middle, while more cones elsewhere.
How to express colors?
Basically, the most intuitive expression is the RGB color space. But it is not a linear color space. We perfer expressing using CIE-XYZ color space, which makes the calculation much easier."><meta name=author content><link rel=canonical href=https://ofuro.me/posts/445_color_basics/><link crossorigin=anonymous href=/assets/css/stylesheet.3f9c3df41d49c1df83c4f93106bd40eae5ce265f122a1a1a99f034136f7c15f5.css integrity="sha256-P5w99B1Jwd+DxPkxBr1A6uXOJl8SKhoamfA0E298FfU=" rel="preload stylesheet" as=style><link rel=icon href=https://ofuro.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ofuro.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ofuro.me/favicon-32x32.png><link rel=apple-touch-icon href=https://ofuro.me/apple-touch-icon.png><link rel=mask-icon href=https://ofuro.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ofuro.me/posts/445_color_basics/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.onload=function(){MathJax.typesetPromise().then(()=>{console.log("MathJax rendering complete.")})}</script><script src=//yihui.org/js/math-code.js defer></script><meta property="og:url" content="https://ofuro.me/posts/445_color_basics/"><meta property="og:site_name" content="Yue's Notes"><meta property="og:title" content="445_color_basics"><meta property="og:description" content="How do you view the world Cones: cone-shaped, less sensitive, operate in high light, color vision
Rods: rod-shaped, highly sensitive, operate at night, gray-scale vision, slower to respond
Observation In a clear night, there are more stars off-center. This is because you have more rods in the middle, while more cones elsewhere.
How to express colors? Basically, the most intuitive expression is the RGB color space. But it is not a linear color space. We perfer expressing using CIE-XYZ color space, which makes the calculation much easier."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-30T10:32:37-05:00"><meta property="article:modified_time" content="2023-10-30T10:32:37-05:00"><meta property="article:tag" content="Computational Photography"><meta name=twitter:card content="summary"><meta name=twitter:title content="445_color_basics"><meta name=twitter:description content="How do you view the world

Cones: cone-shaped, less sensitive, operate in high light, color vision
Rods: rod-shaped, highly sensitive, operate at night, gray-scale vision, slower to respond

Observation In a clear night, there are more stars off-center. This is because you have more rods in the middle, while more cones elsewhere.
How to express colors?
Basically, the most intuitive expression is the RGB color space. But it is not a linear color space. We perfer expressing using CIE-XYZ color space, which makes the calculation much easier."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ofuro.me/posts/"},{"@type":"ListItem","position":2,"name":"445_color_basics","item":"https://ofuro.me/posts/445_color_basics/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"445_color_basics","name":"445_color_basics","description":"How do you view the world Cones: cone-shaped, less sensitive, operate in high light, color vision\nRods: rod-shaped, highly sensitive, operate at night, gray-scale vision, slower to respond\nObservation In a clear night, there are more stars off-center. This is because you have more rods in the middle, while more cones elsewhere.\nHow to express colors? Basically, the most intuitive expression is the RGB color space. But it is not a linear color space. We perfer expressing using CIE-XYZ color space, which makes the calculation much easier.\n","keywords":["Computational Photography"],"articleBody":"How do you view the world Cones: cone-shaped, less sensitive, operate in high light, color vision\nRods: rod-shaped, highly sensitive, operate at night, gray-scale vision, slower to respond\nObservation In a clear night, there are more stars off-center. This is because you have more rods in the middle, while more cones elsewhere.\nHow to express colors? Basically, the most intuitive expression is the RGB color space. But it is not a linear color space. We perfer expressing using CIE-XYZ color space, which makes the calculation much easier.\nHow is light reflected from a surface? Lambertian surface Some light is absorbed The rests are reflected in all direction (diffuse reflection. Think of how you view a piece of white paper) Diffuce reflection, the intensity does depend on illumination angle. $$ I(x) = \\rho(x)(S\\cdot N(x)) $$\nwhere $\\rho$ is albedo, $S$ is the directional source, $N$ is the surface normal, $I$ is the image complexity.\nHowever, perceived intensity does not depend on viewer angle\nSpecular Reflection, consider mirror.\nMost surfaces have these two kinds of reflection. We also have more complicated reflections and refractions.\nColor spaces CIE-XYZ As above.\nCIE L*a*b* This color space sepearates the luminance and chrominance. It turns out that, people gains more information from the luminance channel.\nHSV Hue, Saturation, Value\nYCbCr This is good for fast computation and easier compression.\nEnhancement Color balancing: White balance Simple idea: multiply R, G, and B values by separate constants. $$ \\left[\\begin{array}{l} \\tilde{r} \\ \\tilde{g} \\ \\tilde{b} \\end{array}\\right]=\\left[\\begin{array}{ccc} \\alpha_r \u0026 0 \u0026 0 \\ 0 \u0026 \\alpha_g \u0026 0 \\ 0 \u0026 0 \u0026 \\alpha_b \\end{array}\\right]\\left[\\begin{array}{l} r \\ g \\ b \\end{array}\\right] $$\nGray world assumption. Calculate:\nred_avg as the mean of all the red channel\navg = (red_avg + green_avg + blue_avg) / 3\nChoose $\\alpha_r$ by calculating avg/red_avg\nUse a natural color(white, gray) regeion for calibration. https://stackoverflow.com/questions/54470148/white-balance-a-photo-from-a-known-point gave me an idea:\nGiven an natrual color point, calculate:\nThe luminance of the given point by (choice_r + choice_g + choice_b) / 3 Calculate $\\alpha_r$ by choice_lum/choice_r Gamma adjustment $$ i_{\\text {out }}=i_{\\text {in }}^\\gamma $$\nNote that the input range should be in 0 to 1.\nHistorgram equalization Basic idea: reassign values so that the number of pixels with each value is more evenly distributed. So the histogram should look much smoother instead of having high hills and low valleys.\nThere is an algorithm for global histogram equalization.\nGoal: Given image with pixel values $0 \\leq p j \\leq 255, j=0 . . N$ specify function $\\mathrm{f}(i)$ that remaps pixel values, so that the new values are more broadly distributed\nCompute cumulative histogram: $c(i), i=0 . .255$ $$ h(i)=\\sum_{j \\in \\text { pixels }} \\mathbf{1}\\left(p_j==i\\right), c(i)=c(i-1)+h(i) $$ $\\mathrm{f}(i)=\\alpha \\cdot \\frac{c(i)}{N} \\cdot 255+(1-\\alpha) \\cdot i$ Blends between original image and image with equalized histogram Reference CS445 Derek Hoiem: https://courses.engr.illinois.edu/cs445/fa2023/\n","wordCount":"468","inLanguage":"en","datePublished":"2023-10-30T10:32:37-05:00","dateModified":"2023-10-30T10:32:37-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ofuro.me/posts/445_color_basics/"},"publisher":{"@type":"Organization","name":"Yue's Notes","logo":{"@type":"ImageObject","url":"https://ofuro.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ofuro.me/ accesskey=h title="Yue's Notes (Alt + H)">Yue's Notes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ofuro.me/ title=Notes><span>Notes</span></a></li><li><a href=https://ofuro.me/about title="About Me"><span>About Me</span></a></li><li><a href=https://ofuro.me/archives title=Archive><span>Archive</span></a></li><li><a href=https://ofuro.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://ofuro.me/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">445_color_basics</h1><div class=post-meta><span title='2023-10-30 10:32:37 -0500 -0500'>October 30, 2023</span></div></header><div class=post-content><h3 id=how-do-you-view-the-world>How do you view the world<a hidden class=anchor aria-hidden=true href=#how-do-you-view-the-world>#</a></h3><img src=https://raw.githubusercontent.com/helloboyxxx/images-for-notes/master/uPic/image-20231009180859272.png alt=image-20231009180859272 style=zoom:33%><p><strong>Cones:</strong> cone-shaped, less sensitive, operate in high light, color vision</p><p><strong>Rods:</strong> rod-shaped, highly sensitive, operate at night, gray-scale vision, slower to respond</p><img src=https://raw.githubusercontent.com/helloboyxxx/images-for-notes/master/uPic/image-20231009181400266.png alt=image-20231009181400266 style=zoom:50%><p><span style=color:#9650af>Observation</span> In a clear night, there are more stars off-center. This is because you have more rods in the middle, while more cones elsewhere.</p><h3 id=how-to-express-colors>How to express colors?<a hidden class=anchor aria-hidden=true href=#how-to-express-colors>#</a></h3><p>Basically, the most intuitive expression is the RGB color space. But it is not a linear color space. We perfer expressing using CIE-XYZ color space, which makes the calculation much easier.</p><img src=https://raw.githubusercontent.com/helloboyxxx/images-for-notes/master/uPic/image-20231009181649153.png alt=image-20231009181649153 style=zoom:25%>
<img src="https://github.com/helloboyxxx/images-for-notes/blob/master/uPic/image-20231009182124548.png?raw=true" style=zoom:25%><h3 id=how-is-light-reflected-from-a-surface>How is light reflected from a surface?<a hidden class=anchor aria-hidden=true href=#how-is-light-reflected-from-a-surface>#</a></h3><h4 id=lambertian-surface>Lambertian surface<a hidden class=anchor aria-hidden=true href=#lambertian-surface>#</a></h4><ul><li>Some light is absorbed</li><li>The rests are reflected in all direction (diffuse reflection. Think of how you view a piece of white paper)</li></ul><p><strong>Diffuce reflection</strong>, the intensity does depend on illumination angle.
$$
I(x) = \rho(x)(S\cdot N(x))
$$</p><p>where $\rho$ is albedo, $S$ is the directional source, $N$ is the surface normal, $I$ is the image complexity.</p><p>However, perceived intensity does not depend on viewer angle</p><p><strong>Specular Reflection</strong>, consider mirror.</p><p>Most surfaces have these two kinds of reflection. We also have more complicated reflections and refractions.</p><h3 id=color-spaces>Color spaces<a hidden class=anchor aria-hidden=true href=#color-spaces>#</a></h3><h4 id=cie-xyz>CIE-XYZ<a hidden class=anchor aria-hidden=true href=#cie-xyz>#</a></h4><p>As above.</p><h4 id=cie-lab>CIE L*a*b*<a hidden class=anchor aria-hidden=true href=#cie-lab>#</a></h4><p>This color space sepearates the luminance and chrominance. It turns out that, people gains more information from the luminance channel.</p><img src="https://raw.githubusercontent.com/helloboyxxx/images-for-notes/master/uPic/image-20231009183932935.png?raw=true" alt="CIE LAB" style=zoom:50%><h4 id=hsv>HSV<a hidden class=anchor aria-hidden=true href=#hsv>#</a></h4><p>Hue, Saturation, Value</p><h4 id=ycbcr>YCbCr<a hidden class=anchor aria-hidden=true href=#ycbcr>#</a></h4><p>This is good for fast computation and easier compression.</p><h3 id=enhancement>Enhancement<a hidden class=anchor aria-hidden=true href=#enhancement>#</a></h3><h4 id=color-balancing-white-balance>Color balancing: White balance<a hidden class=anchor aria-hidden=true href=#color-balancing-white-balance>#</a></h4><p>Simple idea: multiply R, G, and B values by separate constants.
$$
\left[\begin{array}{l}
\tilde{r} \
\tilde{g} \
\tilde{b}
\end{array}\right]=\left[\begin{array}{ccc}
\alpha_r & 0 & 0 \
0 & \alpha_g & 0 \
0 & 0 & \alpha_b
\end{array}\right]\left[\begin{array}{l}
r \
g \
b
\end{array}\right]
$$</p><ul><li>Gray world assumption.</li></ul><p>Calculate:</p><p><code>red_avg</code> as the mean of all the red channel</p><p><code>avg = (red_avg + green_avg + blue_avg) / 3</code></p><p>Choose $\alpha_r$ by calculating <code>avg/red_avg</code></p><ul><li>Use a natural color(white, gray) regeion for calibration.</li></ul><p><em><a href=https://stackoverflow.com/questions/54470148/white-balance-a-photo-from-a-known-point>https://stackoverflow.com/questions/54470148/white-balance-a-photo-from-a-known-point</a></em> gave me an idea:</p><p>Given an natrual color point, calculate:</p><ol><li>The luminance of the given point by <code>(choice_r + choice_g + choice_b) / 3</code></li><li>Calculate $\alpha_r$ by <code>choice_lum/choice_r</code></li></ol><h4 id=gamma-adjustment>Gamma adjustment<a hidden class=anchor aria-hidden=true href=#gamma-adjustment>#</a></h4><p>$$
i_{\text {out }}=i_{\text {in }}^\gamma
$$</p><img src=https://raw.githubusercontent.com/helloboyxxx/images-for-notes/master/uPic/image-20231009212509608.png alt=image-20231009212509608 style=zoom:33%><p>Note that the input range should be in 0 to 1.</p><h4 id=historgram-equalization>Historgram equalization<a hidden class=anchor aria-hidden=true href=#historgram-equalization>#</a></h4><p>Basic idea: reassign values so that the number of pixels with each value is more evenly distributed. So the histogram should look much smoother instead of having high hills and low valleys.</p><p>There is an algorithm for global histogram equalization.</p><p>Goal: Given image with pixel values $0 \leq p j \leq 255, j=0 . . N$ specify function $\mathrm{f}(i)$ that remaps pixel values, so that the new values are more broadly distributed</p><ol><li>Compute cumulative histogram: $c(i), i=0 . .255$
$$
h(i)=\sum_{j \in \text { pixels }} \mathbf{1}\left(p_j==i\right), c(i)=c(i-1)+h(i)
$$</li><li>$\mathrm{f}(i)=\alpha \cdot \frac{c(i)}{N} \cdot 255+(1-\alpha) \cdot i$</li></ol><ul><li>Blends between original image and image with equalized histogram</li></ul><h3 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h3><p>CS445 Derek Hoiem: <a href=https://courses.engr.illinois.edu/cs445/fa2023/>https://courses.engr.illinois.edu/cs445/fa2023/</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ofuro.me/tags/computational-photography/>Computational Photography</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://ofuro.me/>Yue's Notes</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>