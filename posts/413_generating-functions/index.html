<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>413_generating Functions | Sam&#39;s Notes</title>
<meta name="keywords" content="Combinatorics">
<meta name="description" content="Generating Functions Generating functions can be regarded as algebraic objects whose formal manipulation allows us to count the number of possibilities for a problem by means of algebra.
Definition
Let $h_0, h_1, h_2, h_3, \ldots$ be an infinite sequence of numbers. Its generating function is defined to be the infinite series: $$ g(x) = h_0 &#43; h_1x &#43; h_2x^2 &#43; \cdots &#43; h_nx^n &#43; \cdots $$
Example 1 The generating function of the infinite sequence $1, 1, 1, \ldots$ is: $$ g(x) = 1 &#43; x &#43; x^2 &#43; x^3 &#43; \cdots $$ for $|x| &lt; 1$.">
<meta name="author" content="">
<link rel="canonical" href="https://ohuro.me/posts/413_generating-functions/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://ohuro.me/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ohuro.me/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ohuro.me/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ohuro.me/apple-touch-icon.png">
<link rel="mask-icon" href="https://ohuro.me/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

 

 <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
 <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 
 
 <script>
   MathJax = {
     tex: {
       inlineMath: [['$', '$'], ['\\(', '\\)']],
       displayMath: [['$$','$$'], ['\\[', '\\]']],
       processEscapes: true,
       processEnvironments: true
     },
     options: {
       skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
     }
   };
 
   window.addEventListener('load', (event) => {
       document.querySelectorAll("mjx-container").forEach(function(x){
         x.parentElement.classList += 'has-jax'})
     });
 
 </script>


<script src="//yihui.org/js/math-code.js" defer></script>

<meta property="og:title" content="413_generating Functions" />
<meta property="og:description" content="Generating Functions Generating functions can be regarded as algebraic objects whose formal manipulation allows us to count the number of possibilities for a problem by means of algebra.
Definition
Let $h_0, h_1, h_2, h_3, \ldots$ be an infinite sequence of numbers. Its generating function is defined to be the infinite series: $$ g(x) = h_0 &#43; h_1x &#43; h_2x^2 &#43; \cdots &#43; h_nx^n &#43; \cdots $$
Example 1 The generating function of the infinite sequence $1, 1, 1, \ldots$ is: $$ g(x) = 1 &#43; x &#43; x^2 &#43; x^3 &#43; \cdots $$ for $|x| &lt; 1$." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ohuro.me/posts/413_generating-functions/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-01T22:48:35-05:00" />
<meta property="article:modified_time" content="2023-11-01T22:48:35-05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="413_generating Functions"/>
<meta name="twitter:description" content="Generating Functions Generating functions can be regarded as algebraic objects whose formal manipulation allows us to count the number of possibilities for a problem by means of algebra.
Definition
Let $h_0, h_1, h_2, h_3, \ldots$ be an infinite sequence of numbers. Its generating function is defined to be the infinite series: $$ g(x) = h_0 &#43; h_1x &#43; h_2x^2 &#43; \cdots &#43; h_nx^n &#43; \cdots $$
Example 1 The generating function of the infinite sequence $1, 1, 1, \ldots$ is: $$ g(x) = 1 &#43; x &#43; x^2 &#43; x^3 &#43; \cdots $$ for $|x| &lt; 1$."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://ohuro.me/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "413_generating Functions",
      "item": "https://ohuro.me/posts/413_generating-functions/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "413_generating Functions",
  "name": "413_generating Functions",
  "description": "Generating Functions Generating functions can be regarded as algebraic objects whose formal manipulation allows us to count the number of possibilities for a problem by means of algebra.\nDefinition\nLet $h_0, h_1, h_2, h_3, \\ldots$ be an infinite sequence of numbers. Its generating function is defined to be the infinite series: $$ g(x) = h_0 + h_1x + h_2x^2 + \\cdots + h_nx^n + \\cdots $$\nExample 1 The generating function of the infinite sequence $1, 1, 1, \\ldots$ is: $$ g(x) = 1 + x + x^2 + x^3 + \\cdots $$ for $|x| \u0026lt; 1$.",
  "keywords": [
    "Combinatorics"
  ],
  "articleBody": "Generating Functions Generating functions can be regarded as algebraic objects whose formal manipulation allows us to count the number of possibilities for a problem by means of algebra.\nDefinition\nLet $h_0, h_1, h_2, h_3, \\ldots$ be an infinite sequence of numbers. Its generating function is defined to be the infinite series: $$ g(x) = h_0 + h_1x + h_2x^2 + \\cdots + h_nx^n + \\cdots $$\nExample 1 The generating function of the infinite sequence $1, 1, 1, \\ldots$ is: $$ g(x) = 1 + x + x^2 + x^3 + \\cdots $$ for $|x| \u003c 1$. This generating function $g(x)$ is the sum of a geometric series with value: $$ g(x) = \\frac{1}{1-x} $$ Solution\n$|x| \u003c 1$, $$ \\begin{align*} (1-x)(1 + x + x^2 + x^3 + \\cdots + x^n) \u0026= 1 - x^{n+1}\\ \\Rightarrow\\ \\lim_{n \\to \\infty}(1-x)(1 + x + x^2 + x^3 + \\cdots + x^n) \u0026= \\lim_{n \\to \\infty}(1 - x^{n+1}) = 1\\ \\Rightarrow\\ \\sum_{j=0}^{\\infty}x^j = \\frac{1}{1-x} \\end{align*} $$ Example 2 Let $m$ be a positive integer. The generating function for the binomial coefficients: $$ \\binom{m}{0}, \\binom{m}{1}, \\ldots, \\binom{m}{m} $$ Solution $$ g(x) = \\binom{m}{0}x + \\binom{m}{1}x^2+ \\ldots+ \\binom{m}{m}x^m = (1+x)^m $$ By the binomial theorem.\nThink about the coefficients of generating functions Example 3 Let $k$ be an integer, and let the sequence $h_0, h_1, h_2, \\ldots$ be defined by letting $h_n$ equal the number of nonnegative integeral solutions of $x_1+x_2+\\cdots+x_k = n.$ Show that the generating function of this sequence is equal to $$ g(x) = \\frac{1}{(1-x)^k} $$\nSolution\nThe goal is to convince ourself that expanding the function $g(x) = \\frac{1}{(1-x)^k}$ give us special coefficients. (What is that? ü§î)\nSince we know that $\\frac{1}{(1-x)} = 1 + x + x^2 + \\ldots$, the expansion becomes: $$ \\begin{align*} \\frac{1}{(1-x)^k} = \\underbrace{(1 + x + x^2 + \\ldots) \\cdot (1 + x + x^2 + \\ldots) \\cdots (1 + x + x^2 + \\ldots)}_{k} \\end{align*} $$ Note that there are $k$ pairs of parenthesis, and from each pair of parentheis, we can choose a $x^i$, for some $i \\geq 0$. Multiplying these $x_i$‚Äôs, say $x^{i_1} \\cdot x^{i_2}\\cdots x^{i_k}$, which is equivalent to $x^{i_1 + i_2 + \\ldots + i_k} = x^n$ for some $n$. Now, given a fixed $n$, we can think about the coefficients of the term $x^n$‚Ä¶ Well, MAGIC !!! This is same as the number of nonnegative integral solutions of $x_1 + x_2 + \\ldots + x_k = n$. Just in different notation!\nTo make this clearer, just write out the definition of generating functions of this sequence: $$ g(x) = h_0 + h_1x + h_2x^2 + h_3x^3 + \\ldots $$ SEE? Each coefficients of $x^n$ corresponds to some choices of $x^i$ from the expansion of $\\frac{1}{(1-x)^k}$. Thus, the sum of all the terms in generating function can be simplified / is equivalent to $\\frac{1}{(1-x)^k}$ . $\\blacksquare$\nThe general trick for generating function problems is to find out an expression for these $h_n$‚Äôs. Sometimes, we make some guesses and multiply a few generating functions together, and observe that the coefficients of $x$‚Äôs in the multiplication is what we want. We will see more examples. (I mean a LOT üôÉ)\nExample 4 (Read example 5 first for better understanding. Also, do compare this two.) For what sequence is $(1+x+x^2+x^3+x^4+x^5)(1+x+x^2)(1+x+x^2+x^3+x^4)$ the generating function?\nSolution\nFor this one, we are trying to construct a case such that, when writing out the generating function for them, we get this expression. This is a ‚Äúreverse designing‚Äù problem. It is hard to come up with these from no where if this is the first time you see them. But, as long as we read/learn more solutions, we can be experienced enough to make correct guesses. That‚Äôs how Combinatoric works. GET USED TO IT üò¢\nObserve that there are three terms multiplied together. Therefore, we may have three kinds of things. Each kind has different copies‚Ä¶ This reminds us of something called multi-set.\nConsider a multi-set: $$ S = \\set{5 \\cdot a, 2 \\cdot b, 4 \\cdot c} $$ The questions is: what is the generating function for the number of $n$-combinations of $S$? $$ g(x) = h_0 + h_1x + h_2x^2 + h_3x^3 + \\ldots $$ Where $h_n$ represents the number of different combinations using $S$. To build the connection between the initial expression and this generating function, simply try to expand it and check the coefficient of each $x^n$. It turns out that the coefficients $h_n$ give us the number of $n$-combinations using $S$. $\\blacksquare$\nExample 5 Determine the generating function for the number of $n$-combinations of apples, bananas, oranges, and pears, where in each $n$-combination, the number of apples is even, the number of bananas is odd, the number of oranges is between $0$ and $4$, and there is at least one pear.\nSolution\nIntuition is to come up to a multiplication of generating functions, where each generating function corresponds to one fruit.\nConsider:\n$(1 + x^2 + x^4 + \\ldots) \\to $ Apples\n$(x + x^3 + x^5 + \\ldots) \\to $ Bananas\n$(1 + x + x^2 + x^3 + x^4) \\to $ Oranges\n$(x + x^2 + x^3 + \\ldots) \\to $ Pears\nNote that the coeff of $x^n$ is the number of $n$-combinations of fruits.\nIf we expand the multiplication of these four terms, we get: $$ g(x) = \\sum_{a_1,\\ldots, a_4}x^{a_1} \\cdot x^{a_2} \\cdot x^{a_3} \\cdot x^{a_4} = \\sum_{n \\geq 0}h_nx^n $$ The coefficients $h_n$ in the expression above is what we want / is what we are asked for. We may first notice that finding the correct coefficients is the goal, then we try to construct the generating functions that satisfies the properties.\nApples $ = \\frac{1}{1-x^2}$ by replacing $x$ by $x^2$.\nBananas $=\\frac{x}{1-x^2}$ by multiplying apple by $x$.\nOranges $= \\frac{1-x^5}{1-x}$ since $(1-x^5) = (1-x)(1 + x + x^3 + x^4)$\nPears $= (\\frac{1}{1-x}-1) = \\frac{x}{1-x}$. Or replace 1 by $x$ in the expression $(1 + x + x^2 + x^3 + \\ldots) = \\frac{1}{1-x}$\nThen we take the multiplication. $\\blacksquare$\nExample 6 Find the number $h_n$ of bags of fruit that can be made out of apples, bananas, oranges, and pears, where, in each bag, the number of apples is even, the number of bananas is a multiple of five, the number of oranges is at most 4, and the number of pears is 0 or 1.\nSolution\nSimilar to Example 5: $$ g(x) = (1 + x^2 + x^4 + \\ldots) (1 + x^5 + x^{10} + \\ldots)(1 + x + x^2 + x^3 + x^4) (1+x) $$ Simplify it to get: $$ g(x) = \\frac{1}{(1-x)^2} $$ To calculate $h_n$ from this, we can use Taylor expansion:\nWHY?\n‚ö†Ô∏è Calc review: $$ \\begin{aligned} \u0026 f \\in \\mathcal{C}^{\\infty}, 0 \\in \\operatorname{Domain}(f) \\\\ \u0026 f(x)=f(0)+\\frac{f^{\\prime}(0)}{1 !} \\cdot x+\\frac{f^{\\prime \\prime}(0)}{2 !} \\cdot x^2+\\ldots \\\\ \u0026 f(x)=\\frac{1}{(1-x)^2} \\\\ \u0026 f^{\\prime}(x)=\\frac{2}{(1-x)^3} \\\\ \u0026 f^{\\prime \\prime}(x)=\\frac{2 \\cdot 3}{(1-x)^4} \\\\ \u0026 f^{(n)}(x)=\\frac{2 \\cdot 3 \\cdots(n+1)}{(1-x)^{n+2}}\\\\ \u0026 f^{(n+1)}(x)=\\frac{2 \\cdot 3 \\cdot(n+1)(n+2)}{(1-x)^{n+3}} \\\\ \u0026 \\end{aligned} $$ For $n \\in \\mathbb{N}:$ $$ \\begin{aligned} \u0026 f^{(n)}(0)=(n+1) ! \\\\ \u0026 f(x)=1+\\frac{2 !}{1 !} x+\\frac{3 !}{2 !} x^2+\\cdots \\\\ \u0026 =1+\\sum_{n \\geqslant 1} \\frac{f^{(n)}(0) x^n}{n !}=1+\\sum_{n \\geqslant 1}^1(n+1) x^n \\end{aligned} $$ Then our answer is simply $h_n = n+1$. $\\blacksquare$\nOR\nWe can solve this in another way: $$ \\begin{align*} \\left(\\frac{1}{1-x}\\right)^\\prime \u0026= (1 + x + x^2 + \\ldots)^\\prime\\\\ \\frac{1}{(1-x)^2} \u0026= 0 + 1 + 2x + 3x^2 + \\ldots \\end{align*} $$ Then we find out that $h_n = n+1$. $\\blacksquare$\nExponential generating functions So far, we defined the generating function for a sequence $\\left(h_n\\right)_{n \\geq 0}$ by using the monomials $1, x, x^2, \\ldots$ There were no coefficient different from 1 in front of these variables.\nThis is particularly suited to some sequences involving combinations and binomial coefficients.\nHowever, for sequences whose terms count permutations, it is more useful to consider a generating function with respect to the monomials $$ 1, x, \\frac{x^2}{2 !}, \\frac{x^3}{3 !}, \\ldots $$ Actually, we have seen these patterns in the Taylor series:\nThese monomials arise in the Taylor series $$ e^x=\\sum_{n=0}^{\\infty} \\frac{x^n}{n !}=1+x+\\frac{x^2}{2 !}+\\frac{x^3}{3 !}+\\cdots $$\nThe exponential generating function for the sequence $\\left(h_n\\right){n \\geq 0}$ is defined to be $$ g^{(e)}(x)=\\sum{n=0}^{\\infty} h_n \\frac{x^n}{n !}=h_0+h_1 x+h_2 \\frac{x^2}{2 !}+h_3 \\frac{x^3}{3 !}+\\cdots $$\nExample 1 Let $n$ be a positive integer. Determine the exponential generating function for the sequence of numbers: $$ P(n, 0), P(n, 1), P(n, 2), \\ldots, P(n, n) $$ where $P(n, k)$ denotes the number of $k$-permutations of an $n$ element set.\nSolution\nWe want to insert $P$‚Äôs into the sequence as $h$‚Äôs. $$ \\sum_{k=0}^{n} = \\frac{P(n,k)x^k}{k!} = \\sum_{k=0}^{n} \\frac{n!}{k!(n-k)!} \\cdot x! = \\sum_{k=0}^{n}\\binom{n}{k}x^k = (1+x)^n $$\nWe can see that the results becomes really clean.\nExample 2 Let $a$ be any real number. Determine the exponential generating function for the sequence $a_0, a_1, a_2, \\ldots$\nSolution $$ \\sum_{k=0}^{n} = \\frac{a^kx^k}{k!} = e^{ax} $$\nLemma\nLet $S$ be the multiset ${n_1 \\cdot a_1, n_2 \\cdot a_2, \\ldots ,n_k \\cdot a_k}$, where $n_1, n_2, \\ldots ,n_k$ are nonnegative integers.\nLet $h_n$ be the number of $n$-permutations of $S$. Then, the exponential generating function $g^{(e)}$ for the sequence $(h_n){n \\ge 0}$ is given by $$ g^{(e)}(x) = f{n_1}(x)f_{n_2}(x)\\cdots f_{n_k}(x). $$\nwhere, for $i = 1,2, \\ldots ,k$,\n$$ f_{n_i}(x) = 1 + x + \\dfrac{x^2}{2!}+ \\cdots + \\dfrac{x^{n_i}}{n_i!}. $$\nProof\nAn $n$-permutation of $S$ is a string of the form:\n$T = t_1 \\cdots t_n$, where $t_i \\in S,\\forall i \\in [n]$ and the number of $a_i$‚Äôs in $T \\leq n_i, \\forall i \\in [k]$.\nDenote: $P_n = $ number of $n$-permutation of $S$. To count $P_n$:\nChoose the multiplicities of each $a_i$ in our string: $j_i$ $a_1$'s, $j_2$ $a_2$'s, ‚Ä¶, $j_k$ $a_k$'s Restriction: $j_1 + \\ldots + j_k = n, j_i \\in [n_i], \\forall i \\in [k]$ The number of $n$-permutations with $j_i$ $a_1$'s, $j_2$ $a_2$'s, ‚Ä¶, $j_k$ $a_k$'s is: $$ \\frac{n!}{j_1! \\cdots j_k!} $$\n$$ \\begin{align*} \\implies P_n = \\sum_{(j_1, \\ldots,j_k): \\text{restriction}}\\frac{n!}{j_1! \\cdots j_k!} \\end{align*} $$ Consider the function: $$ g(x) = \\left( \\sum_{j_1 = 0}^{n_1} \\frac{x^{j_1}}{j_1} \\right) \\cdots \\left( \\sum_{j_k = 0}^{n_k} \\frac{x^{j_k}}{j_k} \\right) $$ Goal: to show that the coef of $x^n$ in $g$ is equal to $P_n / n!$ $$ \\begin{align*} g(x) \u0026= \\sum_{0\\leq j_i \\leq n_i}\\frac{x^{j_1}}{j_1!} \\cdots\\frac{x^{j_k}}{j_k!}\\\\ \u0026=\\sum_{n=0}^{n_1+\\ldots + n_k} \\left( \\sum_{(j_1,\\ldots,j_k):\\text{restriction}} \\frac{1}{j_1! \\cdots j_k!}\\right)\\cdot x^n \\end{align*} $$ This whole thing gives us: $$ g(x) = \\sum_{n=0}^{n_1 + \\ldots + n_k} \\frac{P_n}{n!}x^n $$\nExample 3 Let $h_n$ denote the number of $n$-digit numbers with digits 1,2, or 3 , where the number of 1 ‚Äôs is even, the number of 2 ‚Äôs is at least three, and the number of 3 ‚Äôs is at most four. Determine the exponential generating function $g^{(e)}(x)$ for the resulting sequence of numbers $\\left(h_n\\right)_{n \\geq 0}$.\nSolution $$ \\begin{align*} g^{(e)}(x) \u0026= \\left( 1 + \\frac{x^2}{2!} + \\frac{x^4}{4!} + \\ldots \\right) \u0026\u0026 \\text{choice of num of 1's}\\\\ \u0026\\cdot \\left( \\frac{x^3}{3!} + \\frac{x^4}{4!} + \\frac{x^5}{5!} + \\ldots \\right) \u0026\u0026 \\text{choice of num of 2's}\\\\ \u0026\\cdot \\left( 1 + x + \\frac{x^2}{2!} + \\frac{x^3}{3!} + \\frac{x^4}{4!} \\right)\u0026\u0026 \\text{choice of num of 3's} \\end{align*} $$ The expansion becomes: $$ g^{(e)}(x) = \\sum \\frac{x^{a_1}x^{a_2}x^{a_3}}{a_1!a_2!a_3!} $$\nCoefficient of $x^n$ in $g^{(e)}(x)=$ $$ \\sum_{}^{} \\frac{1}{a_1!a_2!a_3!} = \\frac{h_n}{n!} $$\nHow can we simplify this: $$ \\left( 1 + \\frac{x^2}{2!} + \\frac{x^4}{4!} + \\ldots \\right) = \\frac{e^x + e^{-x}}{2} $$\nand\n$$ \\left( \\frac{x^3}{3!} + \\frac{x^4}{4!} + \\frac{x^5}{5!} + \\ldots \\right) = e^x - 1 - x - \\frac{x^2}{2} $$\nExample 4 Determine the number of ways to color the squares of a 1-by-$n$ chessboard, using the colors, red, white, and blue. Also, an even number of squares are to be colored red.\nSolution $$ g^{(e)}(x) = e^x \\cdot e^x \\cdot \\left( \\frac{e^x + e^{-x}}{2} \\right) = \\frac{e^{3x} + e^x}{2} $$ Using a same logic.\nExample 5 Determine the number $h_n$ of $n$-digit numbers with each digit odd, where the digits 1 and 3 occur an even number of times.\nSolution\nAllowed digits $ = \\set{1, 3, 5, 7, 9}$\nNumber of 1‚Äôs and 3‚Äôs are both even.\n$$ g^{(e)}(x) = \\left( 1 + x + \\frac{x^2}{2!} + \\frac{x^3}{3!} + \\cdots \\right)^3 \\cdot \\left( 1 + \\frac{x^2}{2!} + \\frac{x^4}{4!} + \\cdots \\right)^2 $$\nWhere the first term correspondes to choices for number of 5‚Äôs,7‚Äôs, and 9‚Äôs. Since they are all the same, the term is raised to power of 3. Similarly, the second term corrspondes to choices for 1‚Äôs and 3‚Äôs.\nSimplify this we get: $$ \\begin{align*} g^{(e)}(x) \u0026= \\left( \\frac{e^{-x}+e^x}{2} \\right)^2 \\cdot e^{3x}\\\\ \u0026= \\frac{1}{2}e^{3x} + \\frac{e^x + e^{5x}}{4}\\\\ \u0026= \\frac{1}{4} \\cdot \\left( 2e^{3x} + e^x + e^{5x} \\right) \\end{align*} $$ Now, want to find the coefficients of each term in the Taylor‚Äôs Expansion.\n$e^x = \\left( 1 + x + \\frac{x^2}{2!} + \\frac{x^3}{3!} + \\cdots \\right)$\n$e^{5x} = \\left( 1 + 5x + \\frac{(5x)^2}{2!} + \\frac{(5x)^3}{3!} + \\cdots \\right)$\n$2e^{3x} = \\left( 2 + 2\\cdot(3x) + 2\\cdot\\frac{(3x)^2}{2!} + \\cdots \\right)$\n$$ g^{(e)}(x) = \\frac{1}{4} \\cdot \\sum_{n \\geq 0}\\left( 1+5^n+2\\cdot3^n \\right) \\frac{x^n}{n!} $$ The answer of the counting problem becomes: $$ h_n = \\frac{1 + 5^n + 2 \\cdot 3^n}{4} $$\nExample 6 Determine the number $h_n$ of ways to color the squares of a 1-by-n board with colors ‚Ä¶\n==‚Ä¶==\nSolution\nTBC\nExample 7 Example 8 This example illustrates how to use generating functions to solve linear homogeneous recurrence relations with constant coefficients.\nSolve the recurrence relation: $$ h_n = 5h_{n-1} - 6h_{n-2} \\quad (n \\geq 2) $$ with initial values $h_0 = 1, h_1 = -2$\nPreviously, we get the expression: $$ g(x) = \\frac{5}{1-2x} - \\frac{4}{1-3x} $$ Now, use the fact that $\\frac{1}{1-x} = 1 + x + x^2 + x^3 + \\ldots$, we have: $$ \\begin{align*} g(x) \u0026= 5 \\sum_{n \\geq 0} (2x)^n - 4 \\sum_{n \\geq 0}(3x)^n\\\\ \u0026= \\sum_{n \\geq 0}(5 \\cdot 2^n - 4 \\cdot 3^n)x^n\\\\ \u0026\\implies\\\\ h_n \u0026= 5 \\cdot 2^n - 4 \\cdot 3^n \\end{align*} $$ $\\blacksquare$\nTowers of Hanoi puzzle revisited Instead of using induction, what else can we do?\nLet $h_n$ be the number of moves to transfer $n$ disk from one peg to a different peg and $h_n = 2h_{n-1} + 1$ for $n \\geq 1, h_0 = 0$. Find a closed formula for $h_n$.\nSolution\nNote that this recurrence relation is non-homegeneous. (Definition below)\nNow, back to the solution. Define the following generating functions based on the expression $h_n - 2h_{n-1}-1 = 0$. $$ \\begin{align*} g_1(x) \u0026= h_0 + h_1x + h_2x^2 + h_3x^3 + \\ldots \u0026\u0026 \\text{As usual}\\\\ g_2(x) \u0026= -2h_{-1} -2h_0x - 2h_1x^2 - 2h_2x^3 + \\ldots \u0026\u0026 \\text{using } h_{-1} = 0\\\\ g_3(x) \u0026= 0 -1x - 1x^2 - 1x^3 + \\ldots \u0026\u0026 \\text{using } a_0 = 0, a_i = -1,\\forall i \\geq 1 \\end{align*} $$\nSum them up, we get a zero function: $(g_1 + g_2 + g_3)(x) = 0, \\forall x \\geq 0$\nNow, express $g_2, g_3$ in terms of $g_1$: $$ \\begin{align*} g_2(x) \u0026= g(x) \\cdot (-2x)\\\\ g_3(x) \u0026= -x - x^2 - x^3 - \\ldots = \\frac{-x}{1-x}\\\\ \u0026\\implies\\\\ g_1(x) \u0026\\cdot (1-2x) + g_3(x) = 0\\\\ \u0026\\implies\\\\ g_1(x) \u0026= \\frac{x}{(1-x)(1-2x)} \\end{align*} $$ We want to find Taylor series of this thing. The starting point of breaking this to parts is to construct linear terms: $$ \\begin{align*} g_1(x) \u0026= \\frac{x}{(1-x)(1-2x)} = \\frac{c_1}{1-x} + \\frac{c_2}{1-2x} \\end{align*} $$ Solving for $c_1$ and $c_2$ we get: $$ g_1(x) = \\frac{-1}{1-x} + \\frac{1}{1-2x} $$ As we have $\\frac{1}{1-x} = 1 + x + x^2 + \\ldots$, we conclude: $$ \\begin{align*} g_1(x) \u0026= -\\sum_{n \\geq 0} x^n + \\sum_{n \\geq 0} (2x)^n\\\\ g_1(x) \u0026= \\sum_{n \\geq 0}(2^n - 1)x^n\\\\ \\implies \\\\ h_n \u0026= 2^n - 1 \\end{align*} $$ Now we get THE function for Hanoi‚Äôs Tower.\nDefinition Homogeneous recurrence relation is a recurrence of the form: $$ h_n = a_1 h_{n-1} + a_2h_{n-2} + \\ldots + a_kh_{n-k} $$ Where $k$ and $a_i$‚Äôs are constants.\nDefinition The characteristic polynomial of the homogeneous linear recurrence: $$ \\begin{align*} \\frac{P(x)}{x^{n-k}} \u0026= \\frac{x^n - (a_1 x^{n-1} + a_2 x^{n-2} + \\ldots + a_k x^{n-k})}{x^{n-k}}\\\\ r(x) \u0026= x^k - (a_1x^{k-1} + a_2x^{k-2} + \\ldots + a_kx) \\end{align*} $$ $r(x)$ is the characteristic polynomial of the homogeneous linear recurrence.\nTheorem Let $(h_i)_{i\\ge0}$ be a sequence of numbers defined by the homogeneous recurrence relation\n$$ h_n + a_1h_{n-1}+\\cdots+a_kh_{n-k}=0, , (n \\ge k) $$\nof order $k$ and with initial values for $h_0, h_1,\\ldots,h_{k-1}$.\nLet $r(x) = x^k +a_1 x^{k-1}+a_2x^{k-2}+\\cdots+a_k$ be the characteristic polynomial of this recurrence relation.\nThen, the generating function of $(h_i)_{i\\ge0}$ is given by $g(x) = p(x)/q(x)$, where $q(x) = x^k r(1/x)$ and\n$$ p(x) = h_0 + (h_1+a_1h_0)x+(h_2+a_1h_1+a_2h_0)x^2+\\cdots+(h_{k-1}+a_1h_{k-2}+\\cdots+a_{k-1}h_0)x^{k-1} $$\n$p(x)$ in another form:\n$$ p(x) = \\sum_{i = 0}^{k - 1}\\left( \\sum_{j = 0}^{i} a_jh_{i-j}\\right)x^i $$\nwhere we define $a_0 = 1$.\nNote that this is slightly different from the previous definition, but this is still a homogeneous recurrence relations.\nProof is not given‚Ä¶ I think just understanding this theorem‚Äôs statement what matters.\n",
  "wordCount" : "2799",
  "inLanguage": "en",
  "datePublished": "2023-11-01T22:48:35-05:00",
  "dateModified": "2023-11-01T22:48:35-05:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ohuro.me/posts/413_generating-functions/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Sam's Notes",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ohuro.me/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ohuro.me/" accesskey="h" title="Sam&#39;s Notes (Alt + H)">Sam&#39;s Notes</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ohuro.me/about" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="https://ohuro.me/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://ohuro.me/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://ohuro.me/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      413_generating Functions
    </h1>
    <div class="post-meta"><span title='2023-11-01 22:48:35 -0500 -0500'>November 1, 2023</span>

</div>
  </header> 
  <div class="post-content"><h1 id="generating-functions">Generating Functions<a hidden class="anchor" aria-hidden="true" href="#generating-functions">#</a></h1>
<p>Generating functions can be regarded as algebraic objects whose formal manipulation allows us to count the number of possibilities for a problem by means of algebra.</p>
<p><span style="color:#28a745">Definition</span></p>
<p>Let $h_0, h_1, h_2, h_3, \ldots$ be an infinite sequence of numbers. Its generating function is defined to be the infinite series:
$$
g(x) = h_0 + h_1x + h_2x^2 + \cdots + h_nx^n + \cdots
$$</p>
<h4 id="span-stylecolor04c2b2example-1span"><span style="color:#04c2b2">Example 1</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-1span">#</a></h4>
<p>The generating function of the infinite sequence $1, 1, 1, \ldots$ is:
$$
g(x) = 1 + x + x^2 + x^3 + \cdots
$$
for $|x| &lt; 1$. This generating function $g(x)$ is the sum of a geometric series with value:
$$
g(x) = \frac{1}{1-x}
$$
<strong>Solution</strong></p>
<p>$|x| &lt; 1$,
<code> </code>
$$
\begin{align*}
(1-x)(1 + x + x^2 + x^3 + \cdots + x^n) &amp;= 1 - x^{n+1}\
\Rightarrow\
\lim_{n \to \infty}(1-x)(1 + x + x^2 + x^3 + \cdots + x^n)
&amp;= \lim_{n \to \infty}(1 - x^{n+1}) = 1\
\Rightarrow\
\sum_{j=0}^{\infty}x^j = \frac{1}{1-x}
\end{align*}
$$
<code> </code></p>
<h4 id="span-stylecolor04c2b2example-2span"><span style="color:#04c2b2">Example 2</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-2span">#</a></h4>
<p>Let $m$ be a positive integer. The generating function for the binomial coefficients:
$$
\binom{m}{0}, \binom{m}{1}, \ldots, \binom{m}{m}
$$
<strong>Solution</strong>
$$
g(x) = \binom{m}{0}x + \binom{m}{1}x^2+ \ldots+ \binom{m}{m}x^m = (1+x)^m
$$
By the binomial theorem.</p>
<h3 id="think-about-the-coefficients-of-generating-functions">Think about the coefficients of generating functions<a hidden class="anchor" aria-hidden="true" href="#think-about-the-coefficients-of-generating-functions">#</a></h3>
<h4 id="span-stylecolor04c2b2example-3span"><span style="color:#04c2b2">Example 3</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-3span">#</a></h4>
<p>Let $k$ be an integer, and let the sequence $h_0, h_1, h_2, \ldots$ be defined by letting $h_n$ equal the number of nonnegative integeral solutions of  $x_1+x_2+\cdots+x_k = n.$ Show that the generating function of this sequence is equal to
$$
g(x) = \frac{1}{(1-x)^k}
$$</p>
<p><strong>Solution</strong></p>
<p>The goal is to convince ourself that expanding the function $g(x) = \frac{1}{(1-x)^k}$ give us special coefficients. (What is that? ü§î)</p>
<p>Since we know that $\frac{1}{(1-x)} = 1 + x + x^2 + \ldots$, the expansion becomes:
<code>$$ \begin{align*} \frac{1}{(1-x)^k} = \underbrace{(1 + x + x^2 + \ldots) \cdot (1 + x + x^2 + \ldots) \cdots (1 + x + x^2 + \ldots)}_{k} \end{align*} $$</code>
Note that there are $k$ pairs of parenthesis, and from each pair of parentheis, we can choose a $x^i$, for some $i \geq 0$. Multiplying these $x_i$&rsquo;s, say $x^{i_1} \cdot x^{i_2}\cdots x^{i_k}$, which is equivalent to $x^{i_1 + i_2 + \ldots + i_k} = x^n$ for some $n$. Now, given a fixed $n$, we can think about the coefficients of the term $x^n$&hellip; Well, MAGIC !!! This is same as the number of nonnegative integral solutions of $x_1 + x_2 + \ldots + x_k = n$. Just in different notation!</p>
<p>To make this clearer, just write out the definition of generating functions of this sequence:
$$
g(x) = h_0 + h_1x + h_2x^2 + h_3x^3 + \ldots
$$
SEE? Each coefficients of $x^n$ corresponds to some choices of $x^i$ from the expansion of $\frac{1}{(1-x)^k}$. Thus, the sum of all the terms in generating function can be simplified / is equivalent to $\frac{1}{(1-x)^k}$ . $\blacksquare$</p>
<blockquote>
<p>The general trick for generating function problems is to find out an expression for these $h_n$&rsquo;s. Sometimes, we make some guesses and multiply a few generating functions together, and observe that the coefficients of $x$&rsquo;s in the multiplication is what we want. We will see more examples. (I mean a LOT üôÉ)</p>
</blockquote>
<hr>
<h4 id="span-stylecolor04c2b2example-4span-read-example-5-first-for-better-understanding-also-do-compare-this-two"><span style="color:#04c2b2">Example 4</span> (Read example 5 first for better understanding. Also, do compare this two.)<a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-4span-read-example-5-first-for-better-understanding-also-do-compare-this-two">#</a></h4>
<p>For what sequence is $(1+x+x^2+x^3+x^4+x^5)(1+x+x^2)(1+x+x^2+x^3+x^4)$ the generating function?</p>
<p><strong>Solution</strong></p>
<blockquote>
<p>For this one, we are trying to construct a case such that, when writing out the generating function for them, we get this expression. This is a &ldquo;reverse designing&rdquo; problem. It is hard to come up with these from no where if this is the first time you see them. But, as long as we read/learn more solutions, we can be experienced enough to make correct guesses. That&rsquo;s how Combinatoric works. GET USED TO IT üò¢</p>
</blockquote>
<p>Observe that there are three terms multiplied together. Therefore, we may have three kinds of things. Each kind has different copies&hellip; This reminds us of something called multi-set.</p>
<p>Consider a multi-set:
$$
S = \set{5 \cdot a, 2 \cdot b, 4 \cdot c}
$$
The questions is: what is the generating function for the number of $n$-combinations of $S$?
$$
g(x) = h_0 + h_1x + h_2x^2 + h_3x^3 + \ldots
$$
Where $h_n$ represents the number of different combinations using $S$. To build the connection between the initial expression and this generating function, simply try to expand it and check the coefficient of each $x^n$. It turns out that the coefficients $h_n$ give us the number of $n$-combinations using $S$. $\blacksquare$</p>
<h4 id="span-stylecolor04c2b2example-5span"><span style="color:#04c2b2">Example 5</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-5span">#</a></h4>
<p>Determine the generating function for the number of $n$-combinations of apples, bananas, oranges, and pears, where in each $n$-combination, the number of apples is even, the number of bananas is odd, the number of oranges is between $0$ and $4$, and there is at least one pear.</p>
<p><strong>Solution</strong></p>
<p>Intuition is to come up to a multiplication of generating functions, where each generating function corresponds to one fruit.</p>
<p>Consider:</p>
<p>$(1 + x^2 + x^4 + \ldots) \to $ Apples</p>
<p>$(x + x^3 + x^5 + \ldots) \to $ Bananas</p>
<p>$(1 + x + x^2 + x^3 + x^4) \to $ Oranges</p>
<p>$(x + x^2 + x^3 + \ldots) \to $ Pears</p>
<p>Note that the coeff of $x^n$ is the number of $n$-combinations of fruits.</p>
<p>If we expand the multiplication of these four terms, we get:
$$
g(x) = \sum_{a_1,\ldots, a_4}x^{a_1} \cdot x^{a_2} \cdot x^{a_3} \cdot x^{a_4} = \sum_{n \geq 0}h_nx^n
$$
The coefficients $h_n$ in the expression above is what we want / is what we are asked for. We may first notice that finding the correct coefficients is the goal, then we try to construct the generating functions that satisfies the properties.</p>
<p>Apples $ = \frac{1}{1-x^2}$ by replacing $x$ by $x^2$.</p>
<p>Bananas $=\frac{x}{1-x^2}$ by multiplying apple by $x$.</p>
<p>Oranges $= \frac{1-x^5}{1-x}$ since $(1-x^5) = (1-x)(1 + x + x^3 + x^4)$</p>
<p>Pears $= (\frac{1}{1-x}-1) = \frac{x}{1-x}$. Or replace 1 by $x$ in the expression $(1 + x + x^2 + x^3 + \ldots) = \frac{1}{1-x}$</p>
<p>Then we take the multiplication. $\blacksquare$</p>
<h4 id="span-stylecolor04c2b2example-6span"><span style="color:#04c2b2">Example 6</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-6span">#</a></h4>
<p>Find the number $h_n$ of bags of fruit that can be made out of apples, bananas, oranges, and pears, where, in each bag, the number of apples is even, the number of bananas is a multiple of five, the number of oranges is at most 4, and the number of pears is 0 or 1.</p>
<p><strong>Solution</strong></p>
<p>Similar to Example 5:
$$
g(x) = (1 + x^2 + x^4 + \ldots) (1 + x^5 + x^{10} + \ldots)(1 + x + x^2 + x^3 + x^4) (1+x)
$$
Simplify it to get:
$$
g(x) = \frac{1}{(1-x)^2}
$$
To calculate $h_n$ from this, we can use Taylor expansion:</p>
<blockquote>
<p>WHY?</p>
</blockquote>
<p>‚ö†Ô∏è Calc review:
<code>$$ \begin{aligned} &amp; f \in \mathcal{C}^{\infty}, 0 \in \operatorname{Domain}(f) \\ &amp; f(x)=f(0)+\frac{f^{\prime}(0)}{1 !} \cdot x+\frac{f^{\prime \prime}(0)}{2 !} \cdot x^2+\ldots \\ &amp; f(x)=\frac{1}{(1-x)^2} \\ &amp; f^{\prime}(x)=\frac{2}{(1-x)^3} \\ &amp; f^{\prime \prime}(x)=\frac{2 \cdot 3}{(1-x)^4} \\ &amp; f^{(n)}(x)=\frac{2 \cdot 3 \cdots(n+1)}{(1-x)^{n+2}}\\ &amp; f^{(n+1)}(x)=\frac{2 \cdot 3 \cdot(n+1)(n+2)}{(1-x)^{n+3}} \\ &amp; \end{aligned} $$</code>
For $n \in \mathbb{N}:$
<code>$$ \begin{aligned} &amp; f^{(n)}(0)=(n+1) ! \\ &amp; f(x)=1+\frac{2 !}{1 !} x+\frac{3 !}{2 !} x^2+\cdots \\ &amp; =1+\sum_{n \geqslant 1} \frac{f^{(n)}(0) x^n}{n !}=1+\sum_{n \geqslant 1}^1(n+1) x^n \end{aligned} $$</code>
Then our answer is simply $h_n = n+1$. $\blacksquare$</p>
<p><strong>OR</strong></p>
<p>We can solve this in another way:
<code>$$ \begin{align*} \left(\frac{1}{1-x}\right)^\prime &amp;= (1 + x + x^2 + \ldots)^\prime\\ \frac{1}{(1-x)^2} &amp;= 0 + 1 + 2x + 3x^2 + \ldots \end{align*} $$</code>
Then we find out that $h_n = n+1$. $\blacksquare$</p>
<hr>
<h3 id="exponential-generating-functions">Exponential generating functions<a hidden class="anchor" aria-hidden="true" href="#exponential-generating-functions">#</a></h3>
<p>So far, we defined the generating function for a sequence $\left(h_n\right)_{n \geq 0}$ by using the monomials $1, x, x^2, \ldots$ There were no coefficient different from 1 in front of these variables.</p>
<p>This is particularly suited to some sequences involving <strong>combinations and binomial coefficients</strong>.</p>
<p>However, for sequences whose terms count <strong>permutations</strong>, it is more useful to consider a generating function with respect to the monomials
$$
1, x, \frac{x^2}{2 !}, \frac{x^3}{3 !}, \ldots
$$
Actually, we have seen these patterns in the Taylor series:</p>
<p>These monomials arise in the Taylor series
$$
e^x=\sum_{n=0}^{\infty} \frac{x^n}{n !}=1+x+\frac{x^2}{2 !}+\frac{x^3}{3 !}+\cdots
$$</p>
<p>The exponential generating function for the sequence $\left(h_n\right)<em>{n \geq 0}$ is defined to be
$$
g^{(e)}(x)=\sum</em>{n=0}^{\infty} h_n \frac{x^n}{n !}=h_0+h_1 x+h_2 \frac{x^2}{2 !}+h_3 \frac{x^3}{3 !}+\cdots
$$</p>
<h4 id="span-stylecolor04c2b2example-1span-1"><span style="color:#04c2b2">Example 1</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-1span-1">#</a></h4>
<p>Let $n$ be a positive integer. Determine the exponential generating function for the sequence of numbers:
$$
P(n, 0), P(n, 1), P(n, 2), \ldots, P(n, n)
$$
where $P(n, k)$ denotes the number of $k$-permutations of an $n$ element set.</p>
<p><strong>Solution</strong></p>
<p>We want to insert $P$&rsquo;s into the sequence as $h$&rsquo;s.
$$
\sum_{k=0}^{n} = \frac{P(n,k)x^k}{k!} = \sum_{k=0}^{n} \frac{n!}{k!(n-k)!} \cdot x! = \sum_{k=0}^{n}\binom{n}{k}x^k = (1+x)^n
$$</p>
<blockquote>
<p>We can see that the results becomes really clean.</p>
</blockquote>
<h4 id="span-stylecolor04c2b2example-2span-1"><span style="color:#04c2b2">Example 2</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-2span-1">#</a></h4>
<p>Let $a$ be any real number. Determine the exponential generating function for the sequence $a_0, a_1, a_2, \ldots$</p>
<p><strong>Solution</strong>
$$
\sum_{k=0}^{n} = \frac{a^kx^k}{k!} = e^{ax}
$$</p>
<p><span style="color:#599eff">Lemma</span></p>
<p>Let $S$ be the multiset ${n_1 \cdot a_1, n_2 \cdot a_2, \ldots ,n_k \cdot a_k}$, where $n_1, n_2, \ldots ,n_k$ are nonnegative integers.</p>
<p>Let $h_n$ be the number of $n$-permutations of $S$. Then, the exponential generating function $g^{(e)}$ for the sequence $(h_n)<em>{n \ge 0}$ is given by
$$
g^{(e)}(x) = f</em>{n_1}(x)f_{n_2}(x)\cdots f_{n_k}(x).
$$</p>
<p>where, for $i = 1,2, \ldots ,k$,</p>
<p>$$
f_{n_i}(x) = 1 + x + \dfrac{x^2}{2!}+ \cdots + \dfrac{x^{n_i}}{n_i!}.
$$</p>
<p><span style="color:#eb861c">Proof</span></p>
<p>An $n$-permutation of $S$ is a string of the form:</p>
<p>$T = t_1 \cdots t_n$, where $t_i \in S,\forall i \in [n]$ and the number of $a_i$&rsquo;s in $T \leq n_i, \forall i \in [k]$.</p>
<p>Denote: $P_n = $ number of $n$-permutation of $S$.  To count $P_n$:</p>
<ul>
<li>Choose the multiplicities of each $a_i$ in our string: $j_i$ $a_1$'s, $j_2$ $a_2$'s, &hellip;, $j_k$ $a_k$'s</li>
<li>Restriction: $j_1 + \ldots + j_k = n, j_i \in [n_i], \forall i \in [k]$</li>
</ul>
<p>The number of $n$-permutations with $j_i$ $a_1$'s, $j_2$ $a_2$'s, &hellip;, $j_k$ $a_k$'s is:
$$
\frac{n!}{j_1! \cdots j_k!}
$$</p>
<p><code>$$ \begin{align*} \implies P_n = \sum_{(j_1, \ldots,j_k): \text{restriction}}\frac{n!}{j_1! \cdots j_k!} \end{align*} $$</code>
Consider the function:
$$
g(x) = \left( \sum_{j_1 = 0}^{n_1} \frac{x^{j_1}}{j_1} \right) \cdots
\left( \sum_{j_k = 0}^{n_k} \frac{x^{j_k}}{j_k} \right)
$$
Goal: to show that the coef of $x^n$ in $g$ is equal to $P_n / n!$
<code>$$ \begin{align*} g(x) &amp;= \sum_{0\leq j_i \leq n_i}\frac{x^{j_1}}{j_1!} \cdots\frac{x^{j_k}}{j_k!}\\ &amp;=\sum_{n=0}^{n_1+\ldots + n_k} \left( \sum_{(j_1,\ldots,j_k):\text{restriction}} \frac{1}{j_1! \cdots j_k!}\right)\cdot x^n \end{align*} $$</code>
This whole thing gives us:
$$
g(x) = \sum_{n=0}^{n_1 + \ldots + n_k} \frac{P_n}{n!}x^n
$$</p>
<h4 id="span-stylecolor04c2b2example-3span-1"><span style="color:#04c2b2">Example 3</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-3span-1">#</a></h4>
<p>Let $h_n$ denote the number of $n$-digit numbers with digits 1,2, or 3 , where the number of 1 &rsquo;s is even, the number of 2 &rsquo;s is at least three, and the number of 3 &rsquo;s is at most four. Determine the exponential generating function $g^{(e)}(x)$ for the resulting sequence of numbers $\left(h_n\right)_{n \geq 0}$.</p>
<p><strong>Solution</strong>
<code>$$ \begin{align*} g^{(e)}(x) &amp;= \left( 1 + \frac{x^2}{2!} + \frac{x^4}{4!} + \ldots \right) &amp;&amp; \text{choice of num of 1's}\\ &amp;\cdot \left( \frac{x^3}{3!} + \frac{x^4}{4!} + \frac{x^5}{5!} + \ldots \right) &amp;&amp; \text{choice of num of 2's}\\ &amp;\cdot \left( 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} \right)&amp;&amp; \text{choice of num of 3's} \end{align*} $$</code>
The expansion becomes:
$$
g^{(e)}(x) = \sum \frac{x^{a_1}x^{a_2}x^{a_3}}{a_1!a_2!a_3!}
$$</p>
<p>Coefficient of $x^n$ in $g^{(e)}(x)=$
$$
\sum_{}^{} \frac{1}{a_1!a_2!a_3!} = \frac{h_n}{n!}
$$</p>
<p>How can we simplify this:
$$
\left( 1 + \frac{x^2}{2!} + \frac{x^4}{4!} + \ldots \right) =
\frac{e^x + e^{-x}}{2}
$$</p>
<p>and</p>
<p>$$
\left( \frac{x^3}{3!} + \frac{x^4}{4!} + \frac{x^5}{5!} + \ldots \right) = e^x - 1 - x - \frac{x^2}{2}
$$</p>
<h4 id="span-stylecolor04c2b2example-4span"><span style="color:#04c2b2">Example 4</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-4span">#</a></h4>
<p>Determine the number of ways to color the squares of a 1-by-$n$ chessboard, using the colors, red, white, and blue. Also, an even number of squares are to be colored red.</p>
<p><strong>Solution</strong>
$$
g^{(e)}(x) = e^x \cdot e^x \cdot \left( \frac{e^x + e^{-x}}{2} \right) = \frac{e^{3x} + e^x}{2}
$$
Using a same logic.</p>
<h4 id="span-stylecolor04c2b2example-5span-1"><span style="color:#04c2b2">Example 5</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-5span-1">#</a></h4>
<p>Determine the number $h_n$ of $n$-digit numbers with each digit odd, where the digits 1 and 3 occur an even number of times.</p>
<p><strong>Solution</strong></p>
<p>Allowed digits $ = \set{1, 3, 5, 7, 9}$</p>
<p>Number of 1&rsquo;s and 3&rsquo;s are both even.</p>
<p>$$
g^{(e)}(x) = \left( 1 + x + \frac{x^2}{2!} +  \frac{x^3}{3!} + \cdots \right)^3 \cdot  \left( 1 + \frac{x^2}{2!} +  \frac{x^4}{4!} + \cdots \right)^2
$$</p>
<p>Where the first term correspondes to choices for number of 5&rsquo;s,7&rsquo;s, and 9&rsquo;s. Since they are all the same, the term is raised to power of 3. Similarly, the second term corrspondes to choices for 1&rsquo;s and 3&rsquo;s.</p>
<p>Simplify this we get:
<code>$$ \begin{align*} g^{(e)}(x) &amp;= \left( \frac{e^{-x}+e^x}{2} \right)^2 \cdot e^{3x}\\ &amp;= \frac{1}{2}e^{3x} + \frac{e^x + e^{5x}}{4}\\ &amp;= \frac{1}{4} \cdot \left( 2e^{3x} + e^x + e^{5x} \right) \end{align*} $$</code>
Now, want to find the coefficients of each term in the Taylor&rsquo;s Expansion.</p>
<p>$e^x =  \left( 1 + x + \frac{x^2}{2!} +  \frac{x^3}{3!} + \cdots \right)$</p>
<p>$e^{5x} =  \left( 1 + 5x + \frac{(5x)^2}{2!} +  \frac{(5x)^3}{3!} + \cdots \right)$</p>
<p>$2e^{3x} =  \left( 2 + 2\cdot(3x) + 2\cdot\frac{(3x)^2}{2!} + \cdots \right)$</p>
<p>$$
g^{(e)}(x) = \frac{1}{4} \cdot \sum_{n \geq 0}\left( 1+5^n+2\cdot3^n \right) \frac{x^n}{n!}
$$
The answer of the counting problem becomes:
$$
h_n = \frac{1 + 5^n + 2 \cdot 3^n}{4}
$$</p>
<h4 id="span-stylecolor04c2b2example-6span-1"><span style="color:#04c2b2">Example 6</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-6span-1">#</a></h4>
<p>Determine the number $h_n$ of ways to color the squares of a 1-by-n board with colors &hellip;</p>
<p>==&hellip;==</p>
<p><strong>Solution</strong></p>
<p>TBC</p>
<h4 id="span-stylecolor04c2b2example-7span"><span style="color:#04c2b2">Example 7</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-7span">#</a></h4>
<h4 id="span-stylecolor04c2b2example-8span"><span style="color:#04c2b2">Example 8</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2example-8span">#</a></h4>
<blockquote>
<p>This example illustrates how to use generating functions to solve linear homogeneous recurrence relations with constant coefficients.</p>
</blockquote>
<p>Solve the recurrence relation:
$$
h_n = 5h_{n-1} - 6h_{n-2} \quad (n \geq 2)
$$
with initial values $h_0 = 1, h_1 = -2$</p>
<p>Previously, we get the expression:
$$
g(x) = \frac{5}{1-2x} - \frac{4}{1-3x}
$$
Now, use the fact that $\frac{1}{1-x} = 1 + x + x^2 + x^3 + \ldots$, we have:
<code>$$ \begin{align*} g(x) &amp;= 5 \sum_{n \geq 0} (2x)^n - 4 \sum_{n \geq 0}(3x)^n\\ &amp;= \sum_{n \geq 0}(5 \cdot 2^n - 4 \cdot 3^n)x^n\\ &amp;\implies\\ h_n &amp;= 5 \cdot 2^n - 4 \cdot 3^n \end{align*} $$</code>
$\blacksquare$</p>
<h4 id="span-stylecolor04c2b2towers-of-hanoi-puzzle-revisitedspan"><span style="color:#04c2b2">Towers of Hanoi puzzle revisited</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor04c2b2towers-of-hanoi-puzzle-revisitedspan">#</a></h4>
<blockquote>
<p>Instead of using induction, what else can we do?</p>
</blockquote>
<p>Let $h_n$ be the number of moves to transfer $n$ disk from one peg to a different peg and $h_n = 2h_{n-1} + 1$ for $n \geq 1, h_0 = 0$. Find a closed formula for $h_n$.</p>
<p><strong>Solution</strong></p>
<p>Note that this recurrence relation is non-homegeneous. (Definition below)</p>
<p>Now, back to the solution. Define the following generating functions based on the expression $h_n - 2h_{n-1}-1 = 0$.
<code>$$ \begin{align*} g_1(x) &amp;= h_0 + h_1x + h_2x^2 + h_3x^3 + \ldots &amp;&amp; \text{As usual}\\ g_2(x) &amp;= -2h_{-1} -2h_0x - 2h_1x^2 - 2h_2x^3 + \ldots &amp;&amp; \text{using } h_{-1} = 0\\ g_3(x) &amp;= 0 -1x - 1x^2 - 1x^3 + \ldots &amp;&amp; \text{using } a_0 = 0, a_i = -1,\forall i \geq 1 \end{align*} $$</code></p>
<p>Sum them up, we get a zero function: $(g_1 + g_2 + g_3)(x) = 0, \forall x \geq 0$</p>
<p>Now, express $g_2, g_3$ in terms of $g_1$:
<code>$$ \begin{align*} g_2(x) &amp;= g(x) \cdot (-2x)\\ g_3(x) &amp;= -x - x^2 - x^3 - \ldots = \frac{-x}{1-x}\\ &amp;\implies\\ g_1(x) &amp;\cdot (1-2x) + g_3(x) = 0\\ &amp;\implies\\ g_1(x) &amp;= \frac{x}{(1-x)(1-2x)} \end{align*} $$</code>
We want to find Taylor series of this thing. The starting point of breaking this to parts is to construct linear terms:
<code>$$ \begin{align*} g_1(x) &amp;= \frac{x}{(1-x)(1-2x)} = \frac{c_1}{1-x} + \frac{c_2}{1-2x} \end{align*} $$</code>
Solving for $c_1$ and $c_2$ we get:
$$
g_1(x) = \frac{-1}{1-x} + \frac{1}{1-2x}
$$
As we have $\frac{1}{1-x} = 1 + x + x^2 + \ldots$, we conclude:
<code>$$ \begin{align*} g_1(x) &amp;= -\sum_{n \geq 0} x^n + \sum_{n \geq 0} (2x)^n\\ g_1(x) &amp;= \sum_{n \geq 0}(2^n - 1)x^n\\ \implies \\ h_n &amp;= 2^n - 1 \end{align*} $$</code>
Now we get THE function for Hanoi&rsquo;s Tower.</p>
<hr>
<p><span style="color:#28a745">Definition</span> Homogeneous recurrence relation is a recurrence of the form:
$$
h_n = a_1 h_{n-1} + a_2h_{n-2} + \ldots + a_kh_{n-k}
$$
Where $k$ and $a_i$&rsquo;s are constants.</p>
<p><span style="color:#28a745">Definition</span> The characteristic polynomial of the homogeneous linear recurrence:
<code>$$ \begin{align*} \frac{P(x)}{x^{n-k}} &amp;= \frac{x^n - (a_1 x^{n-1} + a_2 x^{n-2} + \ldots + a_k x^{n-k})}{x^{n-k}}\\ r(x) &amp;= x^k - (a_1x^{k-1} + a_2x^{k-2} + \ldots + a_kx) \end{align*} $$</code>
$r(x)$ is the characteristic polynomial of the homogeneous linear recurrence.</p>
<h3 id="span-stylecolor3c66b5theoremspan"><span style="color:#3c66b5">Theorem</span><a hidden class="anchor" aria-hidden="true" href="#span-stylecolor3c66b5theoremspan">#</a></h3>
<p>Let $(h_i)_{i\ge0}$ be a sequence of numbers defined by the <strong>homogeneous</strong> recurrence relation</p>
<p>$$
h_n + a_1h_{n-1}+\cdots+a_kh_{n-k}=0, , (n \ge k)
$$</p>
<p>of order $k$ and with initial values for $h_0, h_1,\ldots,h_{k-1}$.</p>
<p>Let $r(x) = x^k +a_1 x^{k-1}+a_2x^{k-2}+\cdots+a_k$ be the characteristic polynomial of this recurrence relation.</p>
<p>Then, the generating function of $(h_i)_{i\ge0}$ is given by $g(x) = p(x)/q(x)$, where $q(x) = x^k r(1/x)$ and</p>
<p>$$
p(x) = h_0 + (h_1+a_1h_0)x+(h_2+a_1h_1+a_2h_0)x^2+\cdots+(h_{k-1}+a_1h_{k-2}+\cdots+a_{k-1}h_0)x^{k-1}
$$</p>
<p>$p(x)$ in another form:</p>
<p>$$
p(x) = \sum_{i = 0}^{k - 1}\left( \sum_{j = 0}^{i} a_jh_{i-j}\right)x^i
$$</p>
<p>where we define $a_0 = 1$.</p>
<blockquote>
<p>Note that this is slightly different from the previous definition, but this is still a homogeneous recurrence relations.</p>
</blockquote>
<p><span style="color:#eb861c">Proof</span> is not given&hellip; I think just understanding this theorem&rsquo;s statement what matters.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ohuro.me/tags/combinatorics/">Combinatorics</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://ohuro.me/">Sam&#39;s Notes</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
