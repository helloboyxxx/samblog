<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>413_difference Sequence | Yue's Notes</title>
<meta name=keywords content="Combinatorics"><meta name=description content="⚠️THIS NOTE IS NOT FINISHED YET
TODO:

stirling number definitions
stirling number of the first and the second type
bell number


Question
Can you find a closed formula for the sum of the $p$-th powers of the first $n$ positive integers? That is, we need a closed formulat for the sequence:
$$
h_n=a_p n^p+a_{p-1} n^{p-1}+\cdots+a_1 n+a_0, \quad(n \geq 0)
$$
Solution
The method is to use difference sequences. We already know the following:"><meta name=author content><link rel=canonical href=https://ofuro.me/posts/413_difference-sequence/><link crossorigin=anonymous href=/assets/css/stylesheet.6a49f6cf4a2bdda56a77391d7f5624ae4f617195770e1d3dfe5d3a759ad98336.css integrity="sha256-akn2z0or3aVqdzkdf1Ykrk9hcZV3Dh09/l06dZrZgzY=" rel="preload stylesheet" as=style><link rel=icon href=https://ofuro.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ofuro.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ofuro.me/favicon-32x32.png><link rel=apple-touch-icon href=https://ofuro.me/apple-touch-icon.png><link rel=mask-icon href=https://ofuro.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ofuro.me/posts/413_difference-sequence/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.onload=function(){MathJax.typesetPromise().then(()=>{console.log("MathJax rendering complete.")})}</script><script src=//yihui.org/js/math-code.js defer></script><meta property="og:url" content="https://ofuro.me/posts/413_difference-sequence/"><meta property="og:site_name" content="Yue's Notes"><meta property="og:title" content="413_difference Sequence"><meta property="og:description" content="⚠️THIS NOTE IS NOT FINISHED YET TODO: stirling number definitions stirling number of the first and the second type bell number Question Can you find a closed formula for the sum of the $p$-th powers of the first $n$ positive integers? That is, we need a closed formulat for the sequence:
$$ h_n=a_p n^p+a_{p-1} n^{p-1}+\cdots+a_1 n+a_0, \quad(n \geq 0) $$
Solution
The method is to use difference sequences. We already know the following:"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-11T16:01:49-06:00"><meta property="article:modified_time" content="2023-12-11T16:01:49-06:00"><meta property="article:tag" content="Combinatorics"><meta name=twitter:card content="summary"><meta name=twitter:title content="413_difference Sequence"><meta name=twitter:description content="⚠️THIS NOTE IS NOT FINISHED YET
TODO:

stirling number definitions
stirling number of the first and the second type
bell number


Question
Can you find a closed formula for the sum of the $p$-th powers of the first $n$ positive integers? That is, we need a closed formulat for the sequence:
$$
h_n=a_p n^p+a_{p-1} n^{p-1}+\cdots+a_1 n+a_0, \quad(n \geq 0)
$$
Solution
The method is to use difference sequences. We already know the following:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ofuro.me/posts/"},{"@type":"ListItem","position":2,"name":"413_difference Sequence","item":"https://ofuro.me/posts/413_difference-sequence/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"413_difference Sequence","name":"413_difference Sequence","description":"⚠️THIS NOTE IS NOT FINISHED YET TODO: stirling number definitions stirling number of the first and the second type bell number Question Can you find a closed formula for the sum of the $p$-th powers of the first $n$ positive integers? That is, we need a closed formulat for the sequence:\n$$ h_n=a_p n^p+a_{p-1} n^{p-1}+\\cdots+a_1 n+a_0, \\quad(n \\geq 0) $$\nSolution\nThe method is to use difference sequences. We already know the following:\n","keywords":["Combinatorics"],"articleBody":"⚠️THIS NOTE IS NOT FINISHED YET TODO: stirling number definitions stirling number of the first and the second type bell number Question Can you find a closed formula for the sum of the $p$-th powers of the first $n$ positive integers? That is, we need a closed formulat for the sequence:\n$$ h_n=a_p n^p+a_{p-1} n^{p-1}+\\cdots+a_1 n+a_0, \\quad(n \\geq 0) $$\nSolution\nThe method is to use difference sequences. We already know the following:\n$$ 1^3 + 2^3 + \\ldots + n^3 = (1+2+\\ldots + n)^2 $$ Now we want a new method. First, construct a difference table for $n^3$.\nLet’s verify the following equation:\n$$ 1^3 + \\ldots + n^3 = 0 \\cdot \\binom{n+1}{1} + 1 \\cdot \\binom{n+1}{2} + 6 \\cdot \\binom{n+1}{3} + 6 \\cdot \\binom{n+1}{4} $$\nUse Pascal’s formula for the last two terms. Then expand them to verify that this equation is true.\nDefinition\nLet $(h_n)_{n \\geq 0}$ be a sequence of numbers. We define a new sequence:\n$$ \\Delta h_0, \\Delta h_1, \\Delta h_2, \\ldots, \\Delta h_n, \\ldots $$ call the first-order difference sequence of $(h_n)_{n \\geq 0}$ by:\n$$ \\Delta h_n = h_{n+1} - h_n $$\nDiscrete derivative.\nDefinition\nThe second-order difference sequence of $(h_n)_{n \\ge 0}$ is defined by\n$$ \\Delta^2 h_0, \\Delta^2 h_1, \\Delta^2 h_2, \\ldots, \\Delta^2 h_n, \\ldots, $$ where\n$$ \\Delta^2 h_n = \\Delta(\\Delta h_n) = \\Delta h_{n+1} - \\Delta h_{n}. $$\nThen we can construct the difference table using this new notation:\nTheorem 8.2.1 Let the general term of a sequence be a polynomial of degree $p$ in $n$: $$ h_n = a_pn^p + a_{p-1}n^{p-1} + \\ldots + a_1n + a_0, \\quad(n\\geq 0) $$ Then, $\\Delta^{p+1} h_n = 0$ for all $n \\geq 0$.\nProof\nInduction on $p$. IH:\n$$ \\Delta^{p+1}h_n = 0, \\forall n \\geq 0, \\forall p \\text{-degree sequence } (h_n)_{n\\geq 0} $$\nBase case: $p = 0$, then $(h_n)_{n \\geq 0}$ is a constant sequence $\\implies \\Delta h_n = h_{n+1} - h_n = 0$.\nInduction step: Assume this holds for $p-1, p \\geq 1$. Let’s show that this holds for $p$ as well. We have: $$ \\begin{align*} \\Delta h_n = h_{n+1} - h_n \u0026= \\left(a_p(n+1)^p+a_{p-1}(n+1)^{p-1}+\\cdots+a_1 n+a_0\\right)\\\\ \u0026 \\quad -\\left(a_p n^p+a_{p-1} n^{p-1}+\\cdots+a_1 n+a_0\\right)\\\\ \u0026= (a_p(n+1)^p - a_p n^p) + \\text{polynomial with degree }p-1 \\end{align*} $$ By IH, the polynomial with degree $p-1$ goes to zero. Since we want to show that $\\Delta^{p+1} h_n$ still goes to zero, we need to show that:\n$$ a_p(n+1)^p - a_p n^p = 0 $$\nNow, to solve this, we can use binomial theorm:\n$$ \\begin{align*} a_p(n+1)^p - a_p n^p \u0026= a_p\\left( \\sum_{i=0}^{p}\\binom{p}{i}n^{i} \\right) - a_pn^p\\\\ \u0026= a_p\\left( \\sum_{i=0}^{p-1} \\binom{p}{i}n^i \\right) + a_p n^p - a_pn^p\\\\ \u0026= a_p\\left( \\sum_{i=0}^{p-1} \\binom{p}{i}n^i \\right) \\end{align*} $$ Which means that this polynomial also has degree $p-1$. Combining with the term above, we have: $$ \\Delta ^{p+1} = \\Delta^p(\\Delta h_n) = \\Delta^p(\\text{Polynomial with degree }p-1) = 0 $$ $\\blacksquare$\nLemma Linearity of difference\nLet $(f_n)_{n\\geq 0}$ and $(g_n)_{n\\geq 0}$ be two sequences of numbers. Let $(h_n)_{n\\geq 0}$ be a sequence defined by: $$ h_n = g_n + f_n $$ For every $p \\geq 0$ we have: $$ \\Delta^p h_n = \\Delta^p g_n + \\Delta^p f_n $$ Proof\nIt suffices to show that: $$ \\Delta (f_n + g_n) = \\Delta f_n + \\Delta g_n $$ Expand this and use commutative property to show this:\n$$ \\begin{align*} \\Delta h_n \u0026=h_{n+1}-h_n \\\\ \u0026=\\left(g_{n+1}+f_{n+1}\\right)-\\left(g_n+f_n\\right) \\\\ \u0026=\\left(g_{n+1}-g_n\\right)+\\left(f_{n+1}-f_n\\right) \\\\ \u0026=\\Delta g_n+\\Delta f_n \\end{align*} $$ Question\nCan we recover a sequence by knowing the $0^{\\text{th}}$ diagonal of its difference table?\nNote that the $0-$diagonal has the terms: $$ \\Delta^0 h_0, \\Delta^1 h_0, \\Delta^2 h_0, \\Delta^3 h_0, \\ldots $$\nLemma\nThe general term of the sequence $\\left(h_n\\right)_{n \\geq 0}$ such that the Oth diagonal of its difference table is\n$$ \\underbrace{000 \\cdots 0}_{p \\text { zeros }} 1000 \\cdots $$ equals to\n$$ h_n= \\binom{n}{p} $$ Proof\nFrom the 0-diagonal, we can first try to recover the 1-diagonal, 2-diagonal… and so on:\nSay the $1$ is the fifth number to appear in the 0-diagonal, then it also appears at the fifth position in the first row. All the other terms in the first row are zero. We are then looking for a sequence that has the following properties: $$ h_0 = h_1 = h_2 = h_3 = h_4 = 0, h_1 = 1, $$ Thus, if $h_n$ is sequence of degree 4, it has roots at $0, 1, 2, 3$. Write out out simple guess, we have: $$ h_n = c \\cdot n \\cdot (n-1) \\cdot (n-2) \\cdot (n-3) $$ for some constant $c$. To satisfies the term $h_1 = 1$, $c = \\frac{1}{4!}$. We discover that $h_n = \\binom{n}{4}$. More generally, $h_n = \\binom{n}{p}$ if there are $p$ zeros in the beginning of the 0-diagonal.\nIntuition: using the linearity property of differences and the fact that the 0th diagonal of a difference table determines the entire difference table, and hence the sequence itself, we obtain the next theorem.\nTheorem 8.2.2 The general term of the sequence whose difference table has its 0th diagonal equal to $$ c_0, c_1, c_2, \\ldots, c_p, 0,0,0, \\ldots, \\quad \\text { where } c_p \\neq 0 $$ is a polynomial in $n$ of degree $p$ satisfying $$ h_n=c_0\\left(\\begin{array}{l} n \\ 0 \\end{array}\\right)+c_1\\left(\\begin{array}{l} n \\ 1 \\end{array}\\right)+c_2\\left(\\begin{array}{l} n \\ 2 \\end{array}\\right)+\\cdots+c_p\\left(\\begin{array}{l} n \\ p \\end{array}\\right) $$\nNow, we can back to the initial question: can we find a closed formula for the sum of the $p$-th powers of the first $n$ positive integers? Now we have the tools.\nWe can first write out the difference table. Then, we look at the 0-diagonal, and we reconstruct the sequence, but in the form we see in Theorem 8.2.2. Here is an example:\nExercise\nConsider the sequence with general term $$ h_n=n^3+3 n^2-2 n+1, \\quad(n \\geq 0) $$ The 0-diagonal is $1,2,12,6,0,0, \\ldots$. By using Theorem 8.2.2, we get: $$ h_n = \\binom{n}{0} + 2\\binom{n}{1} +12\\binom{n}{2} + 6\\binom{n}{3} $$ Summing them up: $$ \\sum_{k=0}^{n} h_k = \\sum_{k=0}^{n}\\binom{k}{0} + 2\\sum_{k=0}^{n}\\binom{k}{1} +12\\sum_{k=0}^{n}\\binom{k}{2} + \\sum_{k=0}^{n}6\\binom{k}{3} $$ By hokey-stick identity, this turns to: $$ \\sum_{k=0}^{n} h_k = \\binom{n+1}{1} + 2 \\binom{n+1}{2} + 12 \\binom{n+1}{3} + 6\\binom{n+1}{4} $$\nThe general expression of what we have calculated.\nTheorem Theorem 8.2.3 Assume that the sequence $h_0, h_1, h_2, \\ldots, h_n, \\ldots$ has a difference table whose 0 th diagonal equals $$ c_0, c_1, c_2, \\ldots, c_p, 0,0, \\ldots $$\nThen $$ \\sum_{k=0}^n h_k=c_0\\left(\\begin{array}{c} n+1 \\ 1 \\end{array}\\right)+c_1\\left(\\begin{array}{c} n+1 \\ 2 \\end{array}\\right)+\\cdots+c_p\\left(\\begin{array}{c} n+1 \\ p+1 \\end{array}\\right) $$\nProof is the same as our calculation above.\nNext, we discuss the sequence $$ h_n = n^p $$ for some constant $p$.\nBell numbers\nTheorem If $p \\geq 1$, then $$ B_p = \\binom{p-1}{0} B_0 + \\binom{p-1}{1}B_1 + \\ldots + \\binom{p-1}{p-1}B_{p-1} $$ Proof\nHere is the construction:\nThere are $p$ elements in total, and some boxes.\nFix the element $p$. Fix $t \\in \\set{0, \\ldots, p-1}$ which chooses the number of elements in the box containning $p$. Let $a_t = $ number of the choices of elements which are in the box with $p$, which equals $\\binom{p-1}{t}$\nIt remains to partition $p-(t-1)$ elements into indistinguishable non-empty boxes $B_{p-t-1}$ ways. Writing out the relation we get:\nStirling number of the first kind ==…==\n","wordCount":"1196","inLanguage":"en","datePublished":"2023-12-11T16:01:49-06:00","dateModified":"2023-12-11T16:01:49-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ofuro.me/posts/413_difference-sequence/"},"publisher":{"@type":"Organization","name":"Yue's Notes","logo":{"@type":"ImageObject","url":"https://ofuro.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ofuro.me/ accesskey=h title="Yue's Notes (Alt + H)">Yue's Notes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ofuro.me/about title="About Me"><span>About Me</span></a></li><li><a href=https://ofuro.me/archives title=Archive><span>Archive</span></a></li><li><a href=https://ofuro.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://ofuro.me/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">413_difference Sequence</h1><div class=post-meta><span title='2023-12-11 16:01:49 -0600 -0600'>December 11, 2023</span></div></header><div class=post-content><h2 id=span-stylecolorff0000this-note-is-not-finished-yetspan><span style=color:red>⚠️THIS NOTE IS NOT FINISHED YET</span><a hidden class=anchor aria-hidden=true href=#span-stylecolorff0000this-note-is-not-finished-yetspan>#</a></h2><h3 id=todo>TODO:<a hidden class=anchor aria-hidden=true href=#todo>#</a></h3><ul><li>stirling number definitions</li><li>stirling number of the first and the second type</li><li>bell number</li></ul><hr><h4 id=question>Question<a hidden class=anchor aria-hidden=true href=#question>#</a></h4><p>Can you find a closed formula for the sum of the $p$-th powers of the first $n$ positive integers? That is, we need a closed formulat for the sequence:</p><p>$$
h_n=a_p n^p+a_{p-1} n^{p-1}+\cdots+a_1 n+a_0, \quad(n \geq 0)
$$</p><p><strong>Solution</strong></p><p>The method is to use difference sequences. We already know the following:</p><p>$$
1^3 + 2^3 + \ldots + n^3 = (1+2+\ldots + n)^2
$$
Now we want a new method. First, construct a difference table for $n^3$.</p><img src=https://raw.githubusercontent.com/helloboyxxx/images-for-notes/master/uPic/image-20231127121019537.png alt=image-20231127121019537 style=zoom:50%><p>Let&rsquo;s verify the following equation:</p><p>$$
1^3 + \ldots + n^3 = 0 \cdot \binom{n+1}{1} + 1 \cdot \binom{n+1}{2} + 6 \cdot \binom{n+1}{3} + 6 \cdot \binom{n+1}{4}
$$</p><p>Use Pascal&rsquo;s formula for the last two terms. Then expand them to verify that this equation is true.</p><p><span style=color:#28a745>Definition</span></p><p>Let $(h_n)_{n \geq 0}$ be a sequence of numbers. We define a new sequence:</p><p>$$
\Delta h_0, \Delta h_1, \Delta h_2, \ldots, \Delta h_n, \ldots
$$
call the first-order difference sequence of $(h_n)_{n \geq 0}$ by:</p><p>$$
\Delta h_n = h_{n+1} - h_n
$$</p><blockquote><p>Discrete derivative.</p></blockquote><p><span style=color:#28a745>Definition</span></p><p>The second-order difference sequence of $(h_n)_{n \ge 0}$ is defined by</p><p>$$
\Delta^2 h_0, \Delta^2 h_1, \Delta^2 h_2, \ldots, \Delta^2 h_n, \ldots,
$$
where</p><p>$$
\Delta^2 h_n = \Delta(\Delta h_n) = \Delta h_{n+1} - \Delta h_{n}.
$$</p><p>Then we can construct the difference table using this new notation:</p><img src=https://raw.githubusercontent.com/helloboyxxx/images-for-notes/master/uPic/image-20231129212412033.png alt=image-20231129212412033 style=zoom:50%><h3 id=span-stylecolor3c66b5theoremspan-821><span style=color:#3c66b5>Theorem</span> 8.2.1<a hidden class=anchor aria-hidden=true href=#span-stylecolor3c66b5theoremspan-821>#</a></h3><p>Let the general term of a sequence be a polynomial of degree $p$ in $n$:
$$
h_n = a_pn^p + a_{p-1}n^{p-1} + \ldots + a_1n + a_0, \quad(n\geq 0)
$$
Then, $\Delta^{p+1} h_n = 0$ for all $n \geq 0$.</p><p><span style=color:#eb861c>Proof</span></p><p>Induction on $p$. IH:</p><p>$$
\Delta^{p+1}h_n = 0, \forall n \geq 0, \forall p \text{-degree sequence } (h_n)_{n\geq 0}
$$</p><p>Base case: $p = 0$, then $(h_n)_{n \geq 0}$ is a constant sequence $\implies \Delta h_n = h_{n+1} - h_n = 0$.</p><p>Induction step: Assume this holds for $p-1, p \geq 1$. Let&rsquo;s show that this holds for $p$ as well. We have:<div>$$
\begin{align*}
\Delta h_n = h_{n+1} - h_n &= \left(a_p(n+1)^p+a_{p-1}(n+1)^{p-1}+\cdots+a_1 n+a_0\right)\\
& \quad -\left(a_p n^p+a_{p-1} n^{p-1}+\cdots+a_1 n+a_0\right)\\
&= (a_p(n+1)^p - a_p n^p) + \text{polynomial with degree }p-1
\end{align*}
$$</div>By IH, the polynomial with degree $p-1$ goes to zero. Since we want to show that $\Delta^{p+1} h_n$ still goes to zero, we need to show that:</p><p>$$
a_p(n+1)^p - a_p n^p = 0
$$</p><p>Now, to solve this, we can use binomial theorm:</p><div>$$
\begin{align*}
a_p(n+1)^p - a_p n^p &= a_p\left( \sum_{i=0}^{p}\binom{p}{i}n^{i} \right) - a_pn^p\\
&= a_p\left( \sum_{i=0}^{p-1} \binom{p}{i}n^i \right) + a_p n^p - a_pn^p\\
&= a_p\left( \sum_{i=0}^{p-1} \binom{p}{i}n^i \right)
\end{align*}
$$</div><p>Which means that this polynomial also has degree $p-1$. Combining with the term above, we have:
$$
\Delta ^{p+1} = \Delta^p(\Delta h_n) = \Delta^p(\text{Polynomial with degree }p-1) = 0
$$
$\blacksquare$</p><p><span style=color:#599eff>Lemma</span> Linearity of difference</p><p>Let $(f_n)_{n\geq 0}$ and $(g_n)_{n\geq 0}$ be two sequences of numbers. Let $(h_n)_{n\geq 0}$ be a sequence defined by:
$$
h_n = g_n + f_n
$$
For every $p \geq 0$ we have:
$$
\Delta^p h_n = \Delta^p g_n + \Delta^p f_n
$$
<span style=color:#eb861c>Proof</span></p><p>It suffices to show that:
$$
\Delta (f_n + g_n) = \Delta f_n + \Delta g_n
$$
Expand this and use commutative property to show this:</p><div>$$
\begin{align*}
\Delta h_n &=h_{n+1}-h_n \\ 
&=\left(g_{n+1}+f_{n+1}\right)-\left(g_n+f_n\right) \\
&=\left(g_{n+1}-g_n\right)+\left(f_{n+1}-f_n\right) \\
&=\Delta g_n+\Delta f_n
\end{align*}
$$</div><hr><p><strong>Question</strong></p><p>Can we recover a sequence by knowing the $0^{\text{th}}$ diagonal of its difference table?</p><img src=https://raw.githubusercontent.com/helloboyxxx/images-for-notes/master/uPic/image-20231129212412033.png alt=image-20231129212412033 style=zoom:50%><p>Note that the $0-$diagonal has the terms:
$$
\Delta^0 h_0, \Delta^1 h_0, \Delta^2 h_0, \Delta^3 h_0, \ldots
$$</p><p><span style=color:#599eff>Lemma</span></p><p>The general term of the sequence $\left(h_n\right)_{n \geq 0}$ such that the Oth diagonal of its difference table is</p><p>$$
\underbrace{000 \cdots 0}_{p \text { zeros }} 1000 \cdots
$$
equals to</p><p>$$
h_n= \binom{n}{p}
$$
<span style=color:#eb861c>Proof</span></p><p>From the 0-diagonal, we can first try to recover the 1-diagonal, 2-diagonal&mldr; and so on:</p><img src=https://raw.githubusercontent.com/helloboyxxx/images-for-notes/master/uPic/image-20231205094951946.png alt=image-20231205094951946 style=zoom:50%><p>Say the $1$ is the fifth number to appear in the 0-diagonal, then it also appears at the fifth position in the first row. All the other terms in the first row are zero. We are then looking for a sequence that has the following properties:
$$
h_0 = h_1 = h_2 = h_3 = h_4 = 0, h_1 = 1,
$$
Thus, if $h_n$ is sequence of degree 4, it has roots at $0, 1, 2, 3$. Write out out simple guess, we have:
$$
h_n = c \cdot n \cdot (n-1) \cdot (n-2) \cdot (n-3)
$$
for some constant $c$. To satisfies the term $h_1 = 1$, $c = \frac{1}{4!}$. We discover that $h_n = \binom{n}{4}$. More generally, $h_n = \binom{n}{p}$ if there are $p$ zeros in the beginning of the 0-diagonal.</p><p>Intuition: using the linearity property of differences and the fact that the 0th diagonal of a difference table determines the entire difference table, and hence the sequence itself, we obtain the next theorem.</p><h3 id=span-stylecolor3c66b5theoremspan-822><span style=color:#3c66b5>Theorem</span> 8.2.2<a hidden class=anchor aria-hidden=true href=#span-stylecolor3c66b5theoremspan-822>#</a></h3><p>The general term of the sequence whose difference table has its 0th diagonal equal to
$$
c_0, c_1, c_2, \ldots, c_p, 0,0,0, \ldots, \quad \text { where } c_p \neq 0
$$
is a polynomial in $n$ of degree $p$ satisfying
$$
h_n=c_0\left(\begin{array}{l}
n \
0
\end{array}\right)+c_1\left(\begin{array}{l}
n \
1
\end{array}\right)+c_2\left(\begin{array}{l}
n \
2
\end{array}\right)+\cdots+c_p\left(\begin{array}{l}
n \
p
\end{array}\right)
$$</p><p>Now, we can back to the initial question: can we find a closed formula for the sum of the $p$-th powers of the first $n$ positive integers? Now we have the tools.</p><p>We can first write out the difference table. Then, we look at the 0-diagonal, and we reconstruct the sequence, but in the form we see in Theorem 8.2.2. Here is an example:</p><p><span style=color:#04c2b2>Exercise</span></p><p>Consider the sequence with general term
$$
h_n=n^3+3 n^2-2 n+1, \quad(n \geq 0)
$$
The 0-diagonal is $1,2,12,6,0,0, \ldots$. By using Theorem 8.2.2, we get:
$$
h_n = \binom{n}{0} + 2\binom{n}{1} +12\binom{n}{2} + 6\binom{n}{3}
$$
Summing them up:
$$
\sum_{k=0}^{n} h_k = \sum_{k=0}^{n}\binom{k}{0} + 2\sum_{k=0}^{n}\binom{k}{1} +12\sum_{k=0}^{n}\binom{k}{2} + \sum_{k=0}^{n}6\binom{k}{3}
$$
By hokey-stick identity, this turns to:
$$
\sum_{k=0}^{n} h_k = \binom{n+1}{1} + 2 \binom{n+1}{2} + 12 \binom{n+1}{3} + 6\binom{n+1}{4}
$$</p><blockquote><p>The general expression of what we have calculated.</p></blockquote><h3 id=span-stylecolor3c66b5theoremspan><span style=color:#3c66b5>Theorem</span><a hidden class=anchor aria-hidden=true href=#span-stylecolor3c66b5theoremspan>#</a></h3><p>Theorem 8.2.3 Assume that the sequence $h_0, h_1, h_2, \ldots, h_n, \ldots$ has a difference table whose 0 th diagonal equals
$$
c_0, c_1, c_2, \ldots, c_p, 0,0, \ldots
$$</p><p>Then
$$
\sum_{k=0}^n h_k=c_0\left(\begin{array}{c}
n+1 \
1
\end{array}\right)+c_1\left(\begin{array}{c}
n+1 \
2
\end{array}\right)+\cdots+c_p\left(\begin{array}{c}
n+1 \
p+1
\end{array}\right)
$$</p><blockquote><p>Proof is the same as our calculation above.</p></blockquote><hr><p>Next, we discuss the sequence
$$
h_n = n^p
$$
for some constant $p$.</p><hr><p>Bell numbers</p><h3 id=span-stylecolor3c66b5theoremspan-1><span style=color:#3c66b5>Theorem</span><a hidden class=anchor aria-hidden=true href=#span-stylecolor3c66b5theoremspan-1>#</a></h3><p>If $p \geq 1$, then
$$
B_p = \binom{p-1}{0} B_0 + \binom{p-1}{1}B_1 + \ldots + \binom{p-1}{p-1}B_{p-1}
$$
<span style=color:#eb861c>Proof</span></p><p>Here is the construction:</p><p>There are $p$ elements in total, and some boxes.</p><ul><li>Fix the element $p$.</li><li>Fix $t \in \set{0, \ldots, p-1}$ which chooses the number of elements in the box containning $p$.</li></ul><p>Let $a_t = $ number of the choices of elements which are in the box with $p$, which equals $\binom{p-1}{t}$</p><p>It remains to partition $p-(t-1)$ elements into indistinguishable non-empty boxes $B_{p-t-1}$ ways. Writing out the relation we get:</p><hr><h3 id=stirling-number-of-the-first-kind>Stirling number of the first kind<a hidden class=anchor aria-hidden=true href=#stirling-number-of-the-first-kind>#</a></h3><p>==&mldr;==</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ofuro.me/tags/combinatorics/>Combinatorics</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://ofuro.me/>Yue's Notes</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>